import{a as Tt,c as yt,d as bt,f as wt,g as Dt}from"./chunk-TUIOFNLW.js";import{a as gt,b as ft,d as ht,e as vt,f as Ct,g as xt}from"./chunk-USWXAYLQ.js";import{a as kt}from"./chunk-GDNUC2DO.js";import{a as pt,b as dt,c as ut,d as _t}from"./chunk-VVQWPJ3X.js";import{a as Qe}from"./chunk-2KSCVQJP.js";import{a as st,b as lt}from"./chunk-ONU4FK3W.js";import{b as me}from"./chunk-YOCESGKY.js";import{a as Ke,b as qe,c as He,d as Ue}from"./chunk-PKGH4TD3.js";import{a as $e}from"./chunk-RZWL4VHX.js";import"./chunk-TFZKTK72.js";import{a as Ne,b as ze}from"./chunk-OBMFXYQV.js";import{c as Be}from"./chunk-W4IV6SAA.js";import{a as Oe}from"./chunk-YCUPTL4E.js";import{f as Re}from"./chunk-2WF3BAZE.js";import"./chunk-J44A7NQY.js";import{b as Ee}from"./chunk-K5KQA6TL.js";import"./chunk-6VFWJ4EV.js";import{a as ct,b as mt}from"./chunk-N7K7PRKT.js";import"./chunk-I56K5UOM.js";import{a as nt,b as at,d as ot,e as rt}from"./chunk-7FJFN7F7.js";import{a as Le,e as Ve,i as Ae,j as Pe}from"./chunk-E3OPEBBX.js";import"./chunk-YYH5TD5H.js";import{b as Ge,f as We,g as Xe,l as Ye,o as Je,r as Ze,v as et,w as tt,x as it}from"./chunk-FD45J2AH.js";import{a as ne,c as ae,d as je,e as oe}from"./chunk-IDU54J7C.js";import{b as re,c as se}from"./chunk-FLSFYQN3.js";import{D as Me,E as Fe}from"./chunk-4RUIE36X.js";import"./chunk-ILZLEP6A.js";import"./chunk-GOAOR4JZ.js";import"./chunk-BPAYJYXU.js";import{a as Ie,b as ee,c as te,d as K,e as ie}from"./chunk-KU56Z7YF.js";import{c as Se}from"./chunk-DT5IGS4I.js";import{d as we,h as J,n as De,p as Z}from"./chunk-XQUWTDXC.js";import{Ac as ye,Bb as Ce,C as I,Cc as be,E as ke,Fb as V,G as ce,Gb as _,I as y,Jb as A,Kb as P,Lb as s,Mb as l,Mc as Y,Nb as p,Rb as w,W as b,X as T,Xb as h,Z as R,Zb as k,aa as ge,bb as a,bc as O,cb as v,cc as j,dc as $,ec as M,f as U,fa as fe,fc as d,g as G,ga as q,gc as B,hb as he,hc as F,la as L,m as ue,n as W,nb as ve,pc as N,qc as xe,r as S,rc as z,tc as H,wa as g,xa as f,xb as C,xc as Q,y as _e,yc as Te,zb as m,zc as X}from"./chunk-ABXAS3LN.js";import"./chunk-UGUGGRN7.js";var E=(()=>{let o=class o{constructor(e){this._httpClient=e,this._tags=new G(null),this._task=new G(null),this._tasks=new G(null)}get tags$(){return this._tags.asObservable()}get task$(){return this._task.asObservable()}get tasks$(){return this._tasks.asObservable()}getTags(){return this._httpClient.get("api/apps/tasks/tags").pipe(R(e=>{this._tags.next(e)}))}createTag(e){return this.tags$.pipe(y(1),b(i=>this._httpClient.post("api/apps/tasks/tag",{tag:e}).pipe(S(n=>(this._tags.next([...i,n]),n)))))}updateTag(e,i){return this.tags$.pipe(y(1),b(n=>this._httpClient.patch("api/apps/tasks/tag",{id:e,tag:i}).pipe(S(c=>{let u=n.findIndex(x=>x.id===e);return n[u]=c,this._tags.next(n),c}))))}deleteTag(e){return this.tags$.pipe(y(1),b(i=>this._httpClient.delete("api/apps/tasks/tag",{params:{id:e}}).pipe(S(n=>{let c=i.findIndex(u=>u.id===e);return i.splice(c,1),this._tags.next(i),n}),I(n=>n),b(n=>this.tasks$.pipe(y(1),S(c=>(c.forEach(u=>{let x=u.tags.findIndex(D=>D===e);x>-1&&u.tags.splice(x,1)}),n)))))))}getTasks(){return this._httpClient.get("api/apps/tasks/all").pipe(R(e=>{this._tasks.next(e)}))}updateTasksOrders(e){return this._httpClient.patch("api/apps/tasks/order",{tasks:e})}searchTasks(e){return this._httpClient.get("api/apps/tasks/search",{params:{query:e}})}getTaskById(e){return this._tasks.pipe(y(1),S(i=>{let n=i.find(c=>c.id===e)||null;return this._task.next(n),n}),b(i=>i?ue(i):W("Could not found task with id of "+e+"!")))}createTask(e){return this.tasks$.pipe(y(1),b(i=>this._httpClient.post("api/apps/tasks/task",{type:e}).pipe(S(n=>(this._tasks.next([n,...i]),n)))))}updateTask(e,i){return this.tasks$.pipe(y(1),b(n=>this._httpClient.patch("api/apps/tasks/task",{id:e,task:i}).pipe(S(c=>{let u=n.findIndex(x=>x.id===e);return n[u]=c,this._tasks.next(n),c}),b(c=>this.task$.pipe(y(1),I(u=>u&&u.id===e),R(()=>(this._task.next(c),c)))))))}deleteTask(e){return this.tasks$.pipe(y(1),b(i=>this._httpClient.delete("api/apps/tasks/task",{params:{id:e}}).pipe(S(n=>{let c=i.findIndex(u=>u.id===e);return i.splice(c,1),this._tasks.next(i),n}))))}};o.\u0275fac=function(i){return new(i||o)(fe(Se))},o.\u0275prov=ge({token:o,factory:o.\u0275fac,providedIn:"root"});let t=o;return t})();var Pt=["matDrawer"],Ot=(t,o,r)=>({"h-12 bg-gray-50 text-lg font-semibold dark:bg-transparent":t,"h-16":o,"text-hint":r}),jt=t=>[t];function $t(t,o){t&1&&(s(0,"span"),d(1,"All tasks completed!"),l())}function Bt(t,o){if(t&1&&(s(0,"span"),d(1),l()),t&2){let r=k();a(),F("",r.tasksCount.incomplete," remaining tasks")}}function Nt(t,o){t&1&&p(0,"div",30)}function zt(t,o){t&1&&p(0,"div",21)}function Qt(t,o){t&1&&p(0,"mat-icon",32),t&2&&m("svgIcon","heroicons_outline:check-circle")}function Kt(t,o){t&1&&p(0,"mat-icon",33),t&2&&m("svgIcon","heroicons_outline:check-circle")}function qt(t,o){if(t&1){let r=w();s(0,"button",31),h("click",function(){g(r);let i=k().$implicit,n=k(2);return f(n.toggleCompleted(i))}),C(1,Qt,1,1,"mat-icon",32)(2,Kt,1,1,"mat-icon",33),l()}if(t&2){let r=k().$implicit;a(),_(r.completed?1:-1),a(),_(r.completed?-1:2)}}function Ht(t,o){if(t&1&&(s(0,"span"),d(1),l()),t&2){let r=k().$implicit;a(),B(r.title)}}function Ut(t,o){if(t&1&&(s(0,"span",27),d(1),Q(2,"titlecase"),l()),t&2){let r=k().$implicit;a(),F("",Te(2,1,r.type)," title")}}function Gt(t,o){t&1&&p(0,"mat-icon",34),t&2&&m("svgIcon","heroicons_mini:arrow-long-down")("title","Low")}function Wt(t,o){t&1&&p(0,"mat-icon",35),t&2&&m("svgIcon","heroicons_mini:arrow-long-up")("title","High")}function Xt(t,o){if(t&1&&(s(0,"div",28),C(1,Gt,1,2,"mat-icon",34)(2,Wt,1,2,"mat-icon",35),l()),t&2){let r=k().$implicit;a(),_(r.priority===0?1:-1),a(),_(r.priority===2?2:-1)}}function Yt(t,o){if(t&1&&(s(0,"div",29),d(1),Q(2,"date"),l()),t&2){let r=k().$implicit;a(),F(" ",X(2,1,r.dueDate,"LLL dd")," ")}}function Jt(t,o){if(t&1&&(s(0,"div",18),C(1,Nt,1,0,"div",19),s(2,"div",20),C(3,zt,1,0,"div",21),s(4,"div",22),p(5,"mat-icon",23),l(),C(6,qt,3,2,"button",24),s(7,"a",25)(8,"div",26),C(9,Ht,2,1,"span")(10,Ut,3,3,"span",27),l(),C(11,Xt,3,2,"div",28)(12,Yt,3,4,"div",29),l()()()),t&2){let r=o.$implicit,e=o.$index,i=k(2);Ce("border-t",e===0),m("id","task-"+r.id)("ngClass",H(13,Ot,r.type==="section",r.type==="task",r.completed))("cdkDragLockAxis","y"),a(3),_(i.selectedTask&&i.selectedTask.id===r.id?3:-1),a(2),m("svgIcon","heroicons_solid:bars-3"),a(),_(r.type==="task"?6:-1),a(),m("routerLink",z(17,jt,r.id)),a(2),_(r.title?9:-1),a(),_(r.title?-1:10),a(),_(r.type==="task"?11:-1),a(),_(r.type==="task"?12:-1)}}function Zt(t,o){if(t&1){let r=w();s(0,"div",16),h("cdkDropListDropped",function(i){g(r);let n=k();return f(n.dropped(i))}),A(1,Jt,13,19,"div",17,V().trackByFn,!0),l()}if(t&2){let r=k();m("cdkDropListData",r.tasks),a(),P(r.tasks)}}function ei(t,o){t&1&&(s(0,"div",15),p(1,"mat-icon",36),s(2,"div",37),d(3," Add a task to start planning! "),l()()),t&2&&(a(),m("svgIcon","heroicons_outline:clipboard-document-list"))}var le=(()=>{let o=class o{constructor(e,i,n,c,u,x,D){this._activatedRoute=e,this._changeDetectorRef=i,this._document=n,this._router=c,this._tasksService=u,this._fuseMediaWatcherService=x,this._fuseNavigationService=D,this.tasksCount={completed:0,incomplete:0,total:0},this._unsubscribeAll=new U}ngOnInit(){this._tasksService.tags$.pipe(T(this._unsubscribeAll)).subscribe(e=>{this.tags=e,this._changeDetectorRef.markForCheck()}),this._tasksService.tasks$.pipe(T(this._unsubscribeAll)).subscribe(e=>{this.tasks=e,this.tasksCount.total=this.tasks.filter(i=>i.type==="task").length,this.tasksCount.completed=this.tasks.filter(i=>i.type==="task"&&i.completed).length,this.tasksCount.incomplete=this.tasksCount.total-this.tasksCount.completed,this._changeDetectorRef.markForCheck(),setTimeout(()=>{let i=this._fuseNavigationService.getComponent("mainNavigation");if(i){let n=i.navigation,c=this._fuseNavigationService.getItem("apps.tasks",n);c.subtitle=this.tasksCount.incomplete+" remaining tasks",i.refresh()}})}),this._tasksService.task$.pipe(T(this._unsubscribeAll)).subscribe(e=>{this.selectedTask=e,this._changeDetectorRef.markForCheck()}),this._fuseMediaWatcherService.onMediaQueryChange$("(min-width: 1440px)").pipe(T(this._unsubscribeAll)).subscribe(e=>{this.drawerMode=e.matches?"side":"over",this._changeDetectorRef.markForCheck()}),_e(this._document,"keydown").pipe(T(this._unsubscribeAll),I(e=>(e.ctrlKey===!0||e.metaKey)&&(e.key==="/"||e.key==="."))).subscribe(e=>{e.key==="/"&&this.createTask("task"),e.key==="."&&this.createTask("section")})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}onBackdropClicked(){this._router.navigate(["./"],{relativeTo:this._activatedRoute}),this._changeDetectorRef.markForCheck()}createTask(e){this._tasksService.createTask(e).subscribe(i=>{this._router.navigate(["./",i.id],{relativeTo:this._activatedRoute}),this._changeDetectorRef.markForCheck()})}toggleCompleted(e){e.completed=!e.completed,this._tasksService.updateTask(e.id,e).subscribe(),this._changeDetectorRef.markForCheck()}dropped(e){Tt(e.container.data,e.previousIndex,e.currentIndex),this._tasksService.updateTasksOrders(e.container.data).subscribe(),this._changeDetectorRef.markForCheck()}trackByFn(e,i){return i.id||e}};o.\u0275fac=function(i){return new(i||o)(v(ee),v(Y),v(we),v(K),v(E),v(Be),v(Qe))},o.\u0275cmp=L({type:o,selectors:[["tasks-list"]],viewQuery:function(i,n){if(i&1&&O(Pt,7),i&2){let c;j(c=$())&&(n.matDrawer=c.first)}},standalone:!0,features:[N],decls:25,vars:13,consts:[["matDrawer",""],[1,"absolute","inset-0","flex","min-w-0","flex-col","overflow-hidden"],[1,"bg-card","h-full","flex-auto","dark:bg-transparent",3,"backdropClick"],[1,"w-full","dark:bg-gray-900","sm:w-128",3,"mode","opened","position","disableClose"],[1,"flex","flex-col"],[1,"flex","flex-auto","flex-col"],[1,"flex","flex-col","items-start","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-4xl","font-extrabold","leading-none","tracking-tight"],[1,"text-secondary","ml-0.5","font-medium"],[1,"mt-4","sm:mt-0"],["mat-flat-button","",3,"click","color","matTooltip"],[3,"svgIcon"],[1,"ml-2","mr-1"],["mat-flat-button","",1,"ml-3",3,"click","color","matTooltip"],["cdkDropList","",1,"divide-y",3,"cdkDropListData"],[1,"flex","flex-auto","flex-col","items-center","justify-center","bg-gray-100","dark:bg-transparent"],["cdkDropList","",1,"divide-y",3,"cdkDropListDropped","cdkDropListData"],["cdkDrag","",1,"group","w-full","select-none","dark:hover:bg-hover","hover:bg-gray-100",3,"id","ngClass","border-t","cdkDragLockAxis"],["cdkDrag","",1,"group","w-full","select-none","dark:hover:bg-hover","hover:bg-gray-100",3,"id","ngClass","cdkDragLockAxis"],["class","flex h-0 w-0 flex-0",4,"cdkDragPreview"],[1,"relative","flex","h-full","items-center","pl-10"],[1,"absolute","-bottom-px","-top-px","right-0","z-10","flex","w-1","flex-0","bg-primary"],["cdkDragHandle","",1,"absolute","inset-y-0","left-0","flex","w-8","cursor-move","items-center","justify-center","md:hidden","md:group-hover:flex"],[1,"text-hint","icon-size-5",3,"svgIcon"],["mat-icon-button","",1,"-ml-2.5","mr-2","leading-none"],[1,"flex","h-full","min-w-0","flex-auto","items-center","pr-7",3,"routerLink"],[1,"mr-2","flex-auto","truncate"],[1,"text-hint","select-none"],[1,"mr-3","h-4","w-4"],[1,"text-secondary","whitespace-nowrap","text-sm"],[1,"flex","h-0","w-0","flex-0"],["mat-icon-button","",1,"-ml-2.5","mr-2","leading-none",3,"click"],[1,"text-primary",3,"svgIcon"],[1,"text-hint",3,"svgIcon"],[1,"text-green-600","icon-size-4","dark:text-green-400",3,"svgIcon","title"],[1,"text-red-600","icon-size-4","dark:text-red-400",3,"svgIcon","title"],[1,"icon-size-24",3,"svgIcon"],[1,"text-secondary","mt-4","text-2xl","font-semibold","tracking-tight"]],template:function(i,n){if(i&1){let c=w();s(0,"div",1)(1,"mat-drawer-container",2),h("backdropClick",function(){return g(c),f(n.onBackdropClicked())}),s(2,"mat-drawer",3,0),p(4,"router-outlet"),l(),s(5,"mat-drawer-content",4)(6,"div",5)(7,"div",6)(8,"div")(9,"div",7),d(10," Tasks "),l(),s(11,"div",8),C(12,$t,2,0,"span")(13,Bt,2,1,"span"),l()(),s(14,"div",9)(15,"button",10),h("click",function(){return g(c),f(n.createTask("section"))}),p(16,"mat-icon",11),s(17,"span",12),d(18,"Add Section"),l()(),s(19,"button",13),h("click",function(){return g(c),f(n.createTask("task"))}),p(20,"mat-icon",11),s(21,"span",12),d(22,"Add Task"),l()()()(),C(23,Zt,3,1,"div",14)(24,ei,4,1,"div",15),l()()()()}i&2&&(a(2),m("mode",n.drawerMode)("opened",!1)("position","end")("disableClose",!0),a(10),_(n.tasksCount.incomplete===0?12:-1),a(),_(n.tasksCount.incomplete!==0?13:-1),a(2),m("color","accent")("matTooltip","Shortcut: Ctrl + ."),a(),m("svgIcon","heroicons_outline:plus"),a(3),m("color","primary")("matTooltip","Shortcut: Ctrl + /"),a(),m("svgIcon","heroicons_outline:plus"),a(3),_(n.tasks&&n.tasks.length>0?23:24))},dependencies:[_t,dt,ut,pt,te,oe,ne,ae,ze,Ne,se,re,wt,bt,J,Dt,yt,ie,De,Z],encapsulation:2,changeDetection:0});let t=o;return t})();var ii=["tagsPanelOrigin"],ni=["tagsPanel"],ai=["titleField"],oi=()=>["../"],ri=(t,o,r)=>({"bg-green-200 text-green-800 dark:bg-green-500 dark:text-green-100":t,"bg-gray-200 text-gray-800 dark:bg-gray-500 dark:text-gray-100":o,"bg-red-200 text-red-800 dark:bg-red-500 dark:text-red-100":r}),de=t=>({"bg-hover":t}),si=(t,o,r)=>({"bg-gray-100 text-gray-500 dark:bg-gray-700 dark:text-gray-300":t,"bg-green-200 text-green-800 dark:bg-green-500 dark:text-green-100":o,"bg-red-200 text-red-800 dark:bg-red-500 dark:text-red-100":r});function li(t,o){t&1&&(s(0,"div",11),p(1,"mat-icon",14),s(2,"span",40),d(3,"MARK AS COMPLETE"),l()()),t&2&&(a(),m("svgIcon","heroicons_outline:check-circle"))}function ci(t,o){t&1&&(s(0,"div",11),p(1,"mat-icon",41),s(2,"span",40),d(3,"MARK AS INCOMPLETE"),l()()),t&2&&(a(),m("svgIcon","heroicons_outline:check-circle"))}function mi(t,o){if(t&1&&(s(0,"div",42)(1,"span",43),d(2),l()()),t&2){let r=o.$implicit;a(2),B(r.title)}}function pi(t,o){if(t&1&&(A(0,mi,3,1,"div",42,V().trackByFn,!0),Q(2,"fuseFindByKey")),t&2){let r=k();P(ye(2,0,r.task.tags,"id",r.tags))}}function di(t,o){t&1&&(p(0,"mat-icon",44),s(1,"span",45),d(2,"Edit"),l()),t&2&&m("svgIcon","heroicons_solid:pencil-square")}function ui(t,o){t&1&&(p(0,"mat-icon",44),s(1,"span",45),d(2,"Add"),l()),t&2&&m("svgIcon","heroicons_solid:plus-circle")}function _i(t,o){t&1&&p(0,"mat-icon",44),t&2&&m("svgIcon","heroicons_solid:pencil-square")}function ki(t,o){t&1&&p(0,"mat-icon",44),t&2&&m("svgIcon","heroicons_solid:check")}function gi(t,o){if(t&1){let r=w();s(0,"div",55),h("click",function(){let i=g(r).$implicit,n=k(3);return f(n.toggleTaskTag(i))}),p(1,"mat-checkbox",56),s(2,"div",57),d(3),l()()}if(t&2){let r=o.$implicit,e=k(3);a(),m("checked",e.task.tags.includes(r.id))("color","primary")("disableRipple",!0),a(2),F(" ",r.title," ")}}function fi(t,o){if(t&1&&A(0,gi,4,4,"div",54,V().trackByFn,!0),t&2){let r=k(2);P(r.filteredTags)}}function hi(t,o){if(t&1){let r=w();s(0,"div",12)(1,"mat-form-field",58)(2,"input",59),h("input",function(i){let n=g(r).$implicit,c=k(3);return f(c.updateTagTitle(n,i))}),l(),s(3,"button",60),h("click",function(){let i=g(r).$implicit,n=k(3);return f(n.deleteTag(i))}),p(4,"mat-icon",61),l()()()}if(t&2){let r=o.$implicit;a(),m("subscriptSizing","dynamic"),a(),m("value",r.title),a(2),m("svgIcon","heroicons_solid:trash")}}function vi(t,o){if(t&1&&(s(0,"div",52),A(1,hi,5,3,"div",12,V().trackByFn,!0),l()),t&2){let r=k(2);a(),P(r.filteredTags)}}function Ci(t,o){if(t&1){let r=w();s(0,"div",62),h("click",function(){g(r),k();let i=M(6);return k().createTag(i.value),f(i.value="")}),p(1,"mat-icon",63),s(2,"div",64),d(3,' Create "'),s(4,"b"),d(5),l(),d(6,'" '),l()()}if(t&2){k();let r=M(6);a(),m("svgIcon","heroicons_solid:plus-circle"),a(4),B(r.value)}}function xi(t,o){if(t&1){let r=w();s(0,"div",46)(1,"div",47)(2,"div",12),p(3,"mat-icon",44),s(4,"div",48)(5,"input",49,6),h("input",function(i){g(r);let n=k();return f(n.filterTags(i))})("keydown",function(i){g(r);let n=k();return f(n.filterTagsInputKeyDown(i))}),l()()(),s(7,"button",50),h("click",function(){g(r);let i=k();return f(i.toggleTagsEditMode())}),C(8,_i,1,1,"mat-icon",44)(9,ki,1,1,"mat-icon",44),l()(),s(10,"div",51),C(11,fi,2,0)(12,vi,3,0,"div",52)(13,Ci,7,2,"div",53),l()()}if(t&2){let r=M(6),e=k();a(3),m("svgIcon","heroicons_solid:magnifying-glass"),a(2),m("maxLength",30),a(3),_(e.tagsEditMode?-1:8),a(),_(e.tagsEditMode?9:-1),a(2),_(e.tagsEditMode?-1:11),a(),_(e.tagsEditMode?12:-1),a(),_(e.shouldShowCreateTagButton(r.value)?13:-1)}}function Ti(t,o){t&1&&(p(0,"mat-icon",65),s(1,"span",66),d(2,"Low"),l()),t&2&&m("svgIcon","heroicons_mini:arrow-long-down")}function yi(t,o){t&1&&(p(0,"mat-icon",65),s(1,"span",66),d(2,"Normal"),l()),t&2&&m("svgIcon","heroicons_solid:minus")}function bi(t,o){t&1&&(p(0,"mat-icon",65),s(1,"span",66),d(2,"High"),l()),t&2&&m("svgIcon","heroicons_mini:arrow-long-up")}function wi(t,o){if(t&1&&(d(0),Q(1,"date")),t&2){let r=k();F(" ",X(1,1,r.task.dueDate,"longDate")," ")}}function Di(t,o){t&1&&d(0," Not set ")}var It=(()=>{let o=class o{constructor(e,i,n,c,u,x,D,Ft,Et,Rt){this._activatedRoute=e,this._changeDetectorRef=i,this._formBuilder=n,this._fuseConfirmationService=c,this._renderer2=u,this._router=x,this._tasksListComponent=D,this._tasksService=Ft,this._overlay=Et,this._viewContainerRef=Rt,this.tagsEditMode=!1,this._unsubscribeAll=new U}ngOnInit(){this._tasksListComponent.matDrawer.open(),this.taskForm=this._formBuilder.group({id:[""],type:[""],title:[""],notes:[""],completed:[!1],dueDate:[null],priority:[0],tags:[[]],order:[0]}),this._tasksService.tags$.pipe(T(this._unsubscribeAll)).subscribe(e=>{this.tags=e,this.filteredTags=e,this._changeDetectorRef.markForCheck()}),this._tasksService.tasks$.pipe(T(this._unsubscribeAll)).subscribe(e=>{this.tasks=e,this._changeDetectorRef.markForCheck()}),this._tasksService.task$.pipe(T(this._unsubscribeAll)).subscribe(e=>{this._tasksListComponent.matDrawer.open(),this.task=e,this.taskForm.patchValue(e,{emitEvent:!1}),this._changeDetectorRef.markForCheck()}),this.taskForm.valueChanges.pipe(R(e=>{this.task=Oe(this.task,e)}),ce(300),T(this._unsubscribeAll)).subscribe(e=>{this._tasksService.updateTask(e.id,e).subscribe(),this._changeDetectorRef.markForCheck()}),this._router.events.pipe(T(this._unsubscribeAll),I(e=>e instanceof Ie)).subscribe(()=>{this._titleField.nativeElement.focus()})}ngAfterViewInit(){this._tasksListComponent.matDrawer.openedChange.pipe(T(this._unsubscribeAll),I(e=>e)).subscribe(()=>{this._titleField.nativeElement.focus()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this._tagsPanelOverlayRef&&this._tagsPanelOverlayRef.dispose()}closeDrawer(){return this._tasksListComponent.matDrawer.close()}toggleCompleted(){let e=this.taskForm.get("completed");e.setValue(!e.value)}openTagsPanel(){this._tagsPanelOverlayRef=this._overlay.create({backdropClass:"",hasBackdrop:!0,scrollStrategy:this._overlay.scrollStrategies.block(),positionStrategy:this._overlay.position().flexibleConnectedTo(this._tagsPanelOrigin.nativeElement).withFlexibleDimensions(!0).withViewportMargin(64).withLockedPosition(!0).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"}])}),this._tagsPanelOverlayRef.attachments().subscribe(()=>{this._tagsPanelOverlayRef.overlayElement.querySelector("input").focus()});let e=new Ee(this._tagsPanel,this._viewContainerRef);this._tagsPanelOverlayRef.attach(e),this._tagsPanelOverlayRef.backdropClick().subscribe(()=>{this._tagsPanelOverlayRef&&this._tagsPanelOverlayRef.hasAttached()&&(this._tagsPanelOverlayRef.detach(),this.filteredTags=this.tags,this.tagsEditMode=!1),e&&e.isAttached&&e.detach()})}toggleTagsEditMode(){this.tagsEditMode=!this.tagsEditMode}filterTags(e){let i=e.target.value.toLowerCase();this.filteredTags=this.tags.filter(n=>n.title.toLowerCase().includes(i))}filterTagsInputKeyDown(e){if(e.key!=="Enter")return;if(this.filteredTags.length===0){this.createTag(e.target.value),e.target.value="";return}let i=this.filteredTags[0];this.task.tags.find(c=>c===i.id)?this.deleteTagFromTask(i):this.addTagToTask(i)}createTag(e){let i={title:e};this._tasksService.createTag(i).subscribe(n=>{this.addTagToTask(n)})}updateTagTitle(e,i){e.title=i.target.value,this._tasksService.updateTag(e.id,e).pipe(ce(300)).subscribe(),this._changeDetectorRef.markForCheck()}deleteTag(e){this._tasksService.deleteTag(e.id).subscribe(),this._changeDetectorRef.markForCheck()}addTagToTask(e){this.task.tags.unshift(e.id),this.taskForm.get("tags").patchValue(this.task.tags),this._changeDetectorRef.markForCheck()}deleteTagFromTask(e){this.task.tags.splice(this.task.tags.findIndex(i=>i===e.id),1),this.taskForm.get("tags").patchValue(this.task.tags),this._changeDetectorRef.markForCheck()}toggleTaskTag(e){this.task.tags.includes(e.id)?this.deleteTagFromTask(e):this.addTagToTask(e)}shouldShowCreateTagButton(e){return!(e===""||this.tags.findIndex(i=>i.title.toLowerCase()===e.toLowerCase())>-1)}setTaskPriority(e){this.taskForm.get("priority").setValue(e)}isOverdue(){return me.fromISO(this.task.dueDate).startOf("day")<me.now().startOf("day")}deleteTask(){this._fuseConfirmationService.open({title:"Delete task",message:"Are you sure you want to delete this task? This action cannot be undone!",actions:{confirm:{label:"Delete"}}}).afterClosed().subscribe(i=>{if(i==="confirmed"){let n=this.task.id,c=this.tasks.findIndex(D=>D.id===n),u=c+(c===this.tasks.length-1?-1:1),x=this.tasks.length===1&&this.tasks[0].id===n?null:this.tasks[u].id;this._tasksService.deleteTask(n).subscribe(D=>{D&&(x?this._router.navigate(["../",x],{relativeTo:this._activatedRoute}):this._router.navigate(["../"],{relativeTo:this._activatedRoute}))}),this._changeDetectorRef.markForCheck()}})}trackByFn(e,i){return i.id||e}};o.\u0275fac=function(i){return new(i||o)(v(ee),v(Y),v(et),v($e),v(he),v(K),v(le),v(E),v(Re),v(ve))},o.\u0275cmp=L({type:o,selectors:[["tasks-details"]],viewQuery:function(i,n){if(i&1&&(O(ii,5),O(ni,5),O(ai,5)),i&2){let c;j(c=$())&&(n._tagsPanelOrigin=c.first),j(c=$())&&(n._tagsPanel=c.first),j(c=$())&&(n._titleField=c.first)}},standalone:!0,features:[N],decls:82,vars:53,consts:[["moreMenu","matMenu"],["titleField",""],["tagsPanelOrigin",""],["tagsPanel",""],["priorityMenu","matMenu"],["dueDatePicker",""],["newTagInput",""],[1,"flex","flex-auto"],[1,"flex","flex-auto","flex-col","overflow-y-auto","p-6","pt-10","sm:p-8","sm:pt-10",3,"formGroup"],[1,"-ml-4","-mt-3","flex","items-center","justify-between"],["mat-button","",1,"pl-3.5","pr-4",3,"click"],[1,"flex","items-center","justify-center"],[1,"flex","items-center"],["mat-icon-button","",3,"matMenuTriggerFor"],[3,"svgIcon"],["mat-menu-item","",3,"click"],["mat-icon-button","",3,"routerLink"],[1,"mb-8","mt-6"],[1,"w-full",3,"subscriptSizing"],["matInput","","cdkTextareaAutosize","",3,"formControlName","spellcheck"],[1,"mt-8"],[1,"mb-1.5","font-medium"],[1,"-m-1.5","flex","flex-wrap","items-center"],[1,"m-1.5","flex","cursor-pointer","items-center","justify-center","rounded-full","bg-gray-100","px-4","leading-9","text-gray-500","dark:bg-gray-700","dark:text-gray-300",3,"click"],[1,"mt-8","flex","flex-wrap","items-center"],[1,"font-medium"],[1,"mt-1.5","flex","cursor-pointer","items-center","rounded-full","px-4","leading-9",3,"ngClass","matMenuTriggerFor"],["mat-menu-item","",3,"click","ngClass"],[1,"inline-flex","w-full","min-w-30","items-center","justify-between","leading-5"],[1,"mr-0","text-green-600","icon-size-4","dark:text-green-500",3,"svgIcon"],[1,"mr-0","text-gray-600","icon-size-4","dark:text-gray-500",3,"svgIcon"],[1,"mr-0","text-red-600","icon-size-4","dark:text-red-500",3,"svgIcon"],[1,"ml-6"],[1,"relative","mt-1.5","flex","cursor-pointer","items-center","rounded-full","px-4","leading-9",3,"click","ngClass"],[1,"text-current","icon-size-5",3,"svgIcon"],[1,"ml-2","text-md","font-medium"],[1,"fuse-mat-dense","pointer-events-none","invisible","absolute","inset-0","-mt-2.5","opacity-0",3,"subscriptSizing"],["matInput","",3,"formControlName","matDatepicker"],["mat-button","","matDatepickerCancel","",3,"click"],["mat-flat-button","","matDatepickerApply","",1,"",3,"color"],[1,"ml-2","font-semibold"],[1,"text-primary",3,"svgIcon"],[1,"m-1.5","flex","items-center","justify-center","rounded-full","bg-gray-100","px-4","leading-9","text-gray-500","dark:bg-gray-700","dark:text-gray-300"],[1,"whitespace-nowrap","text-md","font-medium"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-1.5","whitespace-nowrap","text-md","font-medium"],[1,"bg-card","w-60","rounded","border","shadow-md"],[1,"m-3","mr-2","flex","items-center"],[1,"ml-2"],["type","text","placeholder","Enter tag name",1,"w-full","min-w-0","border-0","py-1",3,"input","keydown","maxLength"],["mat-icon-button","",1,"ml-1",3,"click"],[1,"flex","max-h-64","flex-col","overflow-y-auto","border-t","py-2"],[1,"space-y-2","py-2"],["matRipple","",1,"-ml-0.5","flex","h-10","min-h-10","cursor-pointer","items-center","pl-4","pr-3","leading-none","hover:bg-hover"],["matRipple","",1,"flex","h-10","min-h-10","cursor-pointer","items-center","pl-1","pr-4","hover:bg-hover"],["matRipple","",1,"flex","h-10","min-h-10","cursor-pointer","items-center","pl-1","pr-4","hover:bg-hover",3,"click"],[1,"pointer-events-none","flex","h-10","min-h-10","items-center",3,"checked","color","disableRipple"],[1,"ml-1"],[1,"fuse-mat-dense","mx-4","w-full",3,"subscriptSizing"],["matInput","",3,"input","value"],["mat-icon-button","","matSuffix","",3,"click"],[1,"ml-2","icon-size-5",3,"svgIcon"],["matRipple","",1,"-ml-0.5","flex","h-10","min-h-10","cursor-pointer","items-center","pl-4","pr-3","leading-none","hover:bg-hover",3,"click"],[1,"mr-2","icon-size-5",3,"svgIcon"],[1,"break-all"],[1,"text-current","icon-size-4",3,"svgIcon"],[1,"ml-2","mr-1","text-md","font-medium"]],template:function(i,n){if(i&1){let c=w();s(0,"div",7)(1,"form",8)(2,"div",9)(3,"button",10),h("click",function(){return g(c),f(n.toggleCompleted())}),C(4,li,4,1,"div",11)(5,ci,4,1,"div",11),l(),s(6,"div",12)(7,"button",13),p(8,"mat-icon",14),l(),s(9,"mat-menu",null,0)(11,"button",15),h("click",function(){return g(c),f(n.deleteTask())}),p(12,"mat-icon",14),s(13,"span"),d(14),l()()(),s(15,"a",16),p(16,"mat-icon",14),l()()(),p(17,"mat-divider",17),s(18,"div")(19,"mat-form-field",18)(20,"mat-label"),d(21),l(),p(22,"textarea",19,1),l()(),s(24,"div",20)(25,"div",21),d(26,"Tags"),l(),s(27,"div",22),C(28,pi,3,4),s(29,"div",23,2),h("click",function(){return g(c),f(n.openTagsPanel())}),C(31,di,3,1)(32,ui,3,1)(33,xi,14,7,"ng-template",null,3,be),l()()(),s(35,"div",24)(36,"div")(37,"div",25),d(38,"Priority"),l(),s(39,"div",26),C(40,Ti,3,1)(41,yi,3,1)(42,bi,3,1),l(),s(43,"mat-menu",null,4)(45,"button",27),h("click",function(){return g(c),f(n.setTaskPriority(0))}),s(46,"span",28)(47,"span",25),d(48,"Low"),l(),p(49,"mat-icon",29),l()(),s(50,"button",27),h("click",function(){return g(c),f(n.setTaskPriority(1))}),s(51,"span",28)(52,"span",25),d(53,"Normal"),l(),p(54,"mat-icon",30),l()(),s(55,"button",27),h("click",function(){return g(c),f(n.setTaskPriority(2))}),s(56,"span",28)(57,"span",25),d(58,"High"),l(),p(59,"mat-icon",31),l()()()(),s(60,"div",32)(61,"div",25),d(62,"Due date"),l(),s(63,"div",33),h("click",function(){g(c);let x=M(71);return f(x.open())}),p(64,"mat-icon",34),s(65,"span",35),C(66,wi,2,4)(67,Di,1,0),l(),s(68,"mat-form-field",36),p(69,"input",37),s(70,"mat-datepicker",null,5)(72,"mat-datepicker-actions")(73,"button",38),h("click",function(){return g(c),f(n.taskForm.get("dueDate").setValue(null))}),d(74," Clear "),l(),s(75,"button",39),d(76," Select "),l()()()()()()(),s(77,"div",20)(78,"mat-form-field",18)(79,"mat-label"),d(80,"Notes"),l(),p(81,"textarea",19),l()()()()}if(i&2){let c=M(10),u=M(44),x=M(71);a(),m("formGroup",n.taskForm),a(3),_(n.taskForm.get("completed").value?-1:4),a(),_(n.taskForm.get("completed").value?5:-1),a(2),m("matMenuTriggerFor",c),a(),m("svgIcon","heroicons_outline:ellipsis-vertical"),a(4),m("svgIcon","heroicons_outline:trash"),a(2),F("Delete ",n.task.type==="task"?"task":"section",""),a(),m("routerLink",xe(38,oi)),a(),m("svgIcon","heroicons_outline:x-mark"),a(3),m("subscriptSizing","dynamic"),a(2),B(n.task.type==="task"?"Task title":"Section title"),a(),m("formControlName","title")("spellcheck",!1),a(6),_(n.task.tags.length?28:-1),a(3),_(n.task.tags.length?31:-1),a(),_(n.task.tags.length?-1:32),a(7),m("ngClass",H(39,ri,n.task.priority===0,n.task.priority===1,n.task.priority===2))("matMenuTriggerFor",u),a(),_(n.task.priority===0?40:-1),a(),_(n.task.priority===1?41:-1),a(),_(n.task.priority===2?42:-1),a(3),m("ngClass",z(43,de,n.task.priority===0)),a(4),m("svgIcon","heroicons_mini:arrow-long-down"),a(),m("ngClass",z(45,de,n.task.priority===1)),a(4),m("svgIcon","heroicons_solid:minus"),a(),m("ngClass",z(47,de,n.task.priority===2)),a(4),m("svgIcon","heroicons_mini:arrow-long-up"),a(4),m("ngClass",H(49,si,!n.task.dueDate,n.task.dueDate&&!n.isOverdue(),n.task.dueDate&&n.isOverdue())),a(),m("svgIcon","heroicons_solid:calendar"),a(2),_(n.task.dueDate?66:-1),a(),_(n.task.dueDate?-1:67),a(),m("subscriptSizing","dynamic"),a(),m("formControlName","dueDate")("matDatepicker",x),a(6),m("color","primary"),a(3),m("subscriptSizing","dynamic"),a(3),m("formControlName","notes")("spellcheck",!1)}},dependencies:[tt,Ye,Ge,We,Xe,it,Je,Ze,oe,ne,je,ae,se,re,Ue,qe,Ke,He,ie,lt,st,Pe,Ae,Le,Ve,rt,ot,nt,at,Fe,Me,mt,ct,J,xt,gt,ft,Ct,vt,ht,kt,Z],encapsulation:2,changeDetection:0});let t=o;return t})();var Mt=(()=>{let o=class o{constructor(){}};o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=L({type:o,selectors:[["tasks"]],standalone:!0,features:[N],decls:1,vars:0,template:function(i,n){i&1&&p(0,"router-outlet")},dependencies:[te],encapsulation:2,changeDetection:0});let t=o;return t})();var Si=(t,o)=>{let r=q(E),e=q(K);return r.getTaskById(t.paramMap.get("id")).pipe(ke(i=>{console.error(i);let n=o.url.split("/").slice(0,-1).join("/");return e.navigateByUrl(n),W(i)}))},Ii=(t,o,r,e)=>{let i=e.root;for(;i.firstChild;)i=i.firstChild;return!e.url.includes("/tasks")||i.paramMap.get("id")?!0:t.closeDrawer().then(()=>!0)},Mn=[{path:"",component:Mt,resolve:{tags:()=>q(E).getTags()},children:[{path:"",component:le,resolve:{tasks:()=>q(E).getTasks()},children:[{path:":id",component:It,resolve:{task:Si},canDeactivate:[Ii]}]}]}];export{Mn as default};

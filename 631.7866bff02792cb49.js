"use strict";(self.webpackChunkrescue_environment=self.webpackChunkrescue_environment||[]).push([[631],{10631:(Wt,I,r)=>{r.r(I),r.d(I,{default:()=>Ut});var t=r(4020),m=r(77920),A=r(76939),G=r(37403),f=r(60177),d=r(89417),_=r(88834),E=r(82765),M=r(3),v=r(25084),w=r(71997),b=r(30636),y=r(99213),S=r(59042),D=r(59115),P=r(68955),O=r(34948),L=r(44549),Y=r(21413),p=r(56977),F=r(88141),B=r(70152),T=r(5964),U=r(46601),C=r(1875),R=r(90882),N=r(14823),z=r(33726),j=r(84412),u=r(96697),k=r(25558),h=r(96354),X=r(18810),Q=r(7673),H=r(21626);let x=(()=>{class s{constructor(e){this._httpClient=e,this._tags=new j.t(null),this._task=new j.t(null),this._tasks=new j.t(null)}get tags$(){return this._tags.asObservable()}get task$(){return this._task.asObservable()}get tasks$(){return this._tasks.asObservable()}getTags(){return this._httpClient.get("api/apps/tasks/tags").pipe((0,F.M)(e=>{this._tags.next(e)}))}createTag(e){return this.tags$.pipe((0,u.s)(1),(0,k.n)(n=>this._httpClient.post("api/apps/tasks/tag",{tag:e}).pipe((0,h.T)(i=>(this._tags.next([...n,i]),i)))))}updateTag(e,n){return this.tags$.pipe((0,u.s)(1),(0,k.n)(i=>this._httpClient.patch("api/apps/tasks/tag",{id:e,tag:n}).pipe((0,h.T)(a=>{const l=i.findIndex(c=>c.id===e);return i[l]=a,this._tags.next(i),a}))))}deleteTag(e){return this.tags$.pipe((0,u.s)(1),(0,k.n)(n=>this._httpClient.delete("api/apps/tasks/tag",{params:{id:e}}).pipe((0,h.T)(i=>{const a=n.findIndex(l=>l.id===e);return n.splice(a,1),this._tags.next(n),i}),(0,T.p)(i=>i),(0,k.n)(i=>this.tasks$.pipe((0,u.s)(1),(0,h.T)(a=>(a.forEach(l=>{const c=l.tags.findIndex(g=>g===e);c>-1&&l.tags.splice(c,1)}),i)))))))}getTasks(){return this._httpClient.get("api/apps/tasks/all").pipe((0,F.M)(e=>{this._tasks.next(e)}))}updateTasksOrders(e){return this._httpClient.patch("api/apps/tasks/order",{tasks:e})}searchTasks(e){return this._httpClient.get("api/apps/tasks/search",{params:{query:e}})}getTaskById(e){return this._tasks.pipe((0,u.s)(1),(0,h.T)(n=>{const i=n.find(a=>a.id===e)||null;return this._task.next(i),i}),(0,k.n)(n=>n?(0,Q.of)(n):(0,X.$)("Could not found task with id of "+e+"!")))}createTask(e){return this.tasks$.pipe((0,u.s)(1),(0,k.n)(n=>this._httpClient.post("api/apps/tasks/task",{type:e}).pipe((0,h.T)(i=>(this._tasks.next([i,...n]),i)))))}updateTask(e,n){return this.tasks$.pipe((0,u.s)(1),(0,k.n)(i=>this._httpClient.patch("api/apps/tasks/task",{id:e,task:n}).pipe((0,h.T)(a=>{const l=i.findIndex(c=>c.id===e);return i[l]=a,this._tasks.next(i),a}),(0,k.n)(a=>this.task$.pipe((0,u.s)(1),(0,T.p)(l=>l&&l.id===e),(0,F.M)(()=>(this._task.next(a),a)))))))}deleteTask(e){return this.tasks$.pipe((0,u.s)(1),(0,k.n)(n=>this._httpClient.delete("api/apps/tasks/task",{params:{id:e}}).pipe((0,h.T)(i=>{const a=n.findIndex(l=>l.id===e);return n.splice(a,1),this._tasks.next(n),i}))))}static{this.\u0275fac=function(n){return new(n||s)(t.KVO(H.Qq))}}static{this.\u0275prov=t.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();var W=r(27115),J=r(22780);const K=["matDrawer"],Z=(s,o,e)=>({"h-12 bg-gray-50 text-lg font-semibold dark:bg-transparent":s,"h-16":o,"text-hint":e}),q=s=>[s];function tt(s,o){1&s&&(t.j41(0,"span"),t.EFF(1,"All tasks completed!"),t.k0s())}function et(s,o){if(1&s&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&s){const e=t.XpG();t.R7$(),t.SpI("",e.tasksCount.incomplete," remaining tasks")}}function st(s,o){1&s&&t.nrm(0,"div",30)}function it(s,o){1&s&&t.nrm(0,"div",21)}function nt(s,o){1&s&&t.nrm(0,"mat-icon",32),2&s&&t.Y8G("svgIcon","heroicons_outline:check-circle")}function at(s,o){1&s&&t.nrm(0,"mat-icon",33),2&s&&t.Y8G("svgIcon","heroicons_outline:check-circle")}function ot(s,o){if(1&s){const e=t.RV6();t.j41(0,"button",31),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,a=t.XpG(2);return t.Njj(a.toggleCompleted(i))}),t.DNE(1,nt,1,1,"mat-icon",32)(2,at,1,1,"mat-icon",33),t.k0s()}if(2&s){const e=t.XpG().$implicit;t.R7$(),t.vxM(e.completed?1:-1),t.R7$(),t.vxM(e.completed?-1:2)}}function rt(s,o){if(1&s&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&s){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.title)}}function lt(s,o){if(1&s&&(t.j41(0,"span",27),t.EFF(1),t.nI1(2,"titlecase"),t.k0s()),2&s){const e=t.XpG().$implicit;t.R7$(),t.SpI("",t.bMT(2,1,e.type)," title")}}function ct(s,o){1&s&&t.nrm(0,"mat-icon",34),2&s&&t.Y8G("svgIcon","heroicons_mini:arrow-long-down")("title","Low")}function pt(s,o){1&s&&t.nrm(0,"mat-icon",35),2&s&&t.Y8G("svgIcon","heroicons_mini:arrow-long-up")("title","High")}function mt(s,o){if(1&s&&(t.j41(0,"div",28),t.DNE(1,ct,1,2,"mat-icon",34)(2,pt,1,2,"mat-icon",35),t.k0s()),2&s){const e=t.XpG().$implicit;t.R7$(),t.vxM(0===e.priority?1:-1),t.R7$(),t.vxM(2===e.priority?2:-1)}}function dt(s,o){if(1&s&&(t.j41(0,"div",29),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&s){const e=t.XpG().$implicit;t.R7$(),t.SpI(" ",t.i5U(2,1,e.dueDate,"LLL dd")," ")}}function ut(s,o){if(1&s&&(t.j41(0,"div",18),t.DNE(1,st,1,0,"div",19),t.j41(2,"div",20),t.DNE(3,it,1,0,"div",21),t.j41(4,"div",22),t.nrm(5,"mat-icon",23),t.k0s(),t.DNE(6,ot,3,2,"button",24),t.j41(7,"a",25)(8,"div",26),t.DNE(9,rt,2,1,"span")(10,lt,3,3,"span",27),t.k0s(),t.DNE(11,mt,3,2,"div",28)(12,dt,3,4,"div",29),t.k0s()()()),2&s){const e=o.$implicit,n=o.$index,i=t.XpG(2);t.AVh("border-t",0===n),t.Y8G("id","task-"+e.id)("ngClass",t.sMw(13,Z,"section"===e.type,"task"===e.type,e.completed))("cdkDragLockAxis","y"),t.R7$(3),t.vxM(i.selectedTask&&i.selectedTask.id===e.id?3:-1),t.R7$(2),t.Y8G("svgIcon","heroicons_solid:bars-3"),t.R7$(),t.vxM("task"===e.type?6:-1),t.R7$(),t.Y8G("routerLink",t.eq3(17,q,e.id)),t.R7$(2),t.vxM(e.title?9:-1),t.R7$(),t.vxM(e.title?-1:10),t.R7$(),t.vxM("task"===e.type?11:-1),t.R7$(),t.vxM("task"===e.type?12:-1)}}function kt(s,o){if(1&s){const e=t.RV6();t.j41(0,"div",16),t.bIt("cdkDropListDropped",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.dropped(i))}),t.Z7z(1,ut,13,19,"div",17,t.BUC().trackByFn,!0),t.k0s()}if(2&s){const e=t.XpG();t.Y8G("cdkDropListData",e.tasks),t.R7$(),t.Dyx(e.tasks)}}function gt(s,o){1&s&&(t.j41(0,"div",15),t.nrm(1,"mat-icon",36),t.j41(2,"div",37),t.EFF(3," Add a task to start planning! "),t.k0s()()),2&s&&(t.R7$(),t.Y8G("svgIcon","heroicons_outline:clipboard-document-list"))}let V=(()=>{class s{constructor(e,n,i,a,l,c,g){this._activatedRoute=e,this._changeDetectorRef=n,this._document=i,this._router=a,this._tasksService=l,this._fuseMediaWatcherService=c,this._fuseNavigationService=g,this.tasksCount={completed:0,incomplete:0,total:0},this._unsubscribeAll=new Y.B}ngOnInit(){this._tasksService.tags$.pipe((0,p.Q)(this._unsubscribeAll)).subscribe(e=>{this.tags=e,this._changeDetectorRef.markForCheck()}),this._tasksService.tasks$.pipe((0,p.Q)(this._unsubscribeAll)).subscribe(e=>{this.tasks=e,this.tasksCount.total=this.tasks.filter(n=>"task"===n.type).length,this.tasksCount.completed=this.tasks.filter(n=>"task"===n.type&&n.completed).length,this.tasksCount.incomplete=this.tasksCount.total-this.tasksCount.completed,this._changeDetectorRef.markForCheck(),setTimeout(()=>{const n=this._fuseNavigationService.getComponent("mainNavigation");n&&(this._fuseNavigationService.getItem("apps.tasks",n.navigation).subtitle=this.tasksCount.incomplete+" remaining tasks",n.refresh())})}),this._tasksService.task$.pipe((0,p.Q)(this._unsubscribeAll)).subscribe(e=>{this.selectedTask=e,this._changeDetectorRef.markForCheck()}),this._fuseMediaWatcherService.onMediaQueryChange$("(min-width: 1440px)").pipe((0,p.Q)(this._unsubscribeAll)).subscribe(e=>{this.drawerMode=e.matches?"side":"over",this._changeDetectorRef.markForCheck()}),(0,z.R)(this._document,"keydown").pipe((0,p.Q)(this._unsubscribeAll),(0,T.p)(e=>(!0===e.ctrlKey||e.metaKey)&&("/"===e.key||"."===e.key))).subscribe(e=>{"/"===e.key&&this.createTask("task"),"."===e.key&&this.createTask("section")})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}onBackdropClicked(){this._router.navigate(["./"],{relativeTo:this._activatedRoute}),this._changeDetectorRef.markForCheck()}createTask(e){this._tasksService.createTask(e).subscribe(n=>{this._router.navigate(["./",n.id],{relativeTo:this._activatedRoute}),this._changeDetectorRef.markForCheck()})}toggleCompleted(e){e.completed=!e.completed,this._tasksService.updateTask(e.id,e).subscribe(),this._changeDetectorRef.markForCheck()}dropped(e){(0,C.HD)(e.container.data,e.previousIndex,e.currentIndex),this._tasksService.updateTasksOrders(e.container.data).subscribe(),this._changeDetectorRef.markForCheck()}trackByFn(e,n){return n.id||e}static{this.\u0275fac=function(n){return new(n||s)(t.rXU(m.nX),t.rXU(t.gRc),t.rXU(f.qQ),t.rXU(m.Ix),t.rXU(x),t.rXU(W.F),t.rXU(J.L5))}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["tasks-list"]],viewQuery:function(n,i){if(1&n&&t.GBs(K,7),2&n){let a;t.mGM(a=t.lsd())&&(i.matDrawer=a.first)}},decls:25,vars:13,consts:[["matDrawer",""],[1,"absolute","inset-0","flex","min-w-0","flex-col","overflow-hidden"],[1,"bg-card","h-full","flex-auto","dark:bg-transparent",3,"backdropClick"],[1,"w-full","dark:bg-gray-900","sm:w-128",3,"mode","opened","position","disableClose"],[1,"flex","flex-col"],[1,"flex","flex-auto","flex-col"],[1,"flex","flex-col","items-start","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-4xl","font-extrabold","leading-none","tracking-tight"],[1,"text-secondary","ml-0.5","font-medium"],[1,"mt-4","sm:mt-0"],["mat-flat-button","",3,"click","color","matTooltip"],[3,"svgIcon"],[1,"ml-2","mr-1"],["mat-flat-button","",1,"ml-3",3,"click","color","matTooltip"],["cdkDropList","",1,"divide-y",3,"cdkDropListData"],[1,"flex","flex-auto","flex-col","items-center","justify-center","bg-gray-100","dark:bg-transparent"],["cdkDropList","",1,"divide-y",3,"cdkDropListDropped","cdkDropListData"],["cdkDrag","",1,"group","w-full","select-none","dark:hover:bg-hover","hover:bg-gray-100",3,"id","ngClass","border-t","cdkDragLockAxis"],["cdkDrag","",1,"group","w-full","select-none","dark:hover:bg-hover","hover:bg-gray-100",3,"id","ngClass","cdkDragLockAxis"],["class","flex h-0 w-0 flex-0",4,"cdkDragPreview"],[1,"relative","flex","h-full","items-center","pl-10"],[1,"absolute","-bottom-px","-top-px","right-0","z-10","flex","w-1","flex-0","bg-primary"],["cdkDragHandle","",1,"absolute","inset-y-0","left-0","flex","w-8","cursor-move","items-center","justify-center","md:hidden","md:group-hover:flex"],[1,"text-hint","icon-size-5",3,"svgIcon"],["mat-icon-button","",1,"-ml-2.5","mr-2","leading-none"],[1,"flex","h-full","min-w-0","flex-auto","items-center","pr-7",3,"routerLink"],[1,"mr-2","flex-auto","truncate"],[1,"text-hint","select-none"],[1,"mr-3","h-4","w-4"],[1,"text-secondary","whitespace-nowrap","text-sm"],[1,"flex","h-0","w-0","flex-0"],["mat-icon-button","",1,"-ml-2.5","mr-2","leading-none",3,"click"],[1,"text-primary",3,"svgIcon"],[1,"text-hint",3,"svgIcon"],[1,"text-green-600","icon-size-4","dark:text-green-400",3,"svgIcon","title"],[1,"text-red-600","icon-size-4","dark:text-red-400",3,"svgIcon","title"],[1,"icon-size-24",3,"svgIcon"],[1,"text-secondary","mt-4","text-2xl","font-semibold","tracking-tight"]],template:function(n,i){if(1&n){const a=t.RV6();t.j41(0,"div",1)(1,"mat-drawer-container",2),t.bIt("backdropClick",function(){return t.eBV(a),t.Njj(i.onBackdropClicked())}),t.j41(2,"mat-drawer",3,0),t.nrm(4,"router-outlet"),t.k0s(),t.j41(5,"mat-drawer-content",4)(6,"div",5)(7,"div",6)(8,"div")(9,"div",7),t.EFF(10," Tasks "),t.k0s(),t.j41(11,"div",8),t.DNE(12,tt,2,0,"span")(13,et,2,1,"span"),t.k0s()(),t.j41(14,"div",9)(15,"button",10),t.bIt("click",function(){return t.eBV(a),t.Njj(i.createTask("section"))}),t.nrm(16,"mat-icon",11),t.j41(17,"span",12),t.EFF(18,"Add Section"),t.k0s()(),t.j41(19,"button",13),t.bIt("click",function(){return t.eBV(a),t.Njj(i.createTask("task"))}),t.nrm(20,"mat-icon",11),t.j41(21,"span",12),t.EFF(22,"Add Task"),t.k0s()()()(),t.DNE(23,kt,3,1,"div",14)(24,gt,4,1,"div",15),t.k0s()()()()}2&n&&(t.R7$(2),t.Y8G("mode",i.drawerMode)("opened",!1)("position","end")("disableClose",!0),t.R7$(10),t.vxM(0===i.tasksCount.incomplete?12:-1),t.R7$(),t.vxM(0!==i.tasksCount.incomplete?13:-1),t.R7$(2),t.Y8G("color","accent")("matTooltip","Shortcut: Ctrl + ."),t.R7$(),t.Y8G("svgIcon","heroicons_outline:plus"),t.R7$(3),t.Y8G("color","primary")("matTooltip","Shortcut: Ctrl + /"),t.R7$(),t.Y8G("svgIcon","heroicons_outline:plus"),t.R7$(3),t.vxM(i.tasks&&i.tasks.length>0?23:24))},dependencies:[R.vg,R.qe,R.$C,R.$l,m.n3,_.Hl,_.$z,_.iY,N.uc,N.oV,y.m_,y.An,C.O7,C.T1,f.YU,C.r0,C.Fb,m.Wk,f.PV,f.vh],encapsulation:2,changeDetection:0})}}return s})();var ht=r(47987);const _t=["tagsPanelOrigin"],ft=["tagsPanel"],vt=["titleField"],Tt=()=>["../"],Ct=(s,o,e)=>({"bg-green-200 text-green-800 dark:bg-green-500 dark:text-green-100":s,"bg-gray-200 text-gray-800 dark:bg-gray-500 dark:text-gray-100":o,"bg-red-200 text-red-800 dark:bg-red-500 dark:text-red-100":e}),$=s=>({"bg-hover":s}),xt=(s,o,e)=>({"bg-gray-100 text-gray-500 dark:bg-gray-700 dark:text-gray-300":s,"bg-green-200 text-green-800 dark:bg-green-500 dark:text-green-100":o,"bg-red-200 text-red-800 dark:bg-red-500 dark:text-red-100":e});function bt(s,o){1&s&&(t.j41(0,"div",11),t.nrm(1,"mat-icon",14),t.j41(2,"span",40),t.EFF(3,"MARK AS COMPLETE"),t.k0s()()),2&s&&(t.R7$(),t.Y8G("svgIcon","heroicons_outline:check-circle"))}function yt(s,o){1&s&&(t.j41(0,"div",11),t.nrm(1,"mat-icon",41),t.j41(2,"span",40),t.EFF(3,"MARK AS INCOMPLETE"),t.k0s()()),2&s&&(t.R7$(),t.Y8G("svgIcon","heroicons_outline:check-circle"))}function Dt(s,o){if(1&s&&(t.j41(0,"div",42)(1,"span",43),t.EFF(2),t.k0s()()),2&s){const e=o.$implicit;t.R7$(2),t.JRh(e.title)}}function Ft(s,o){if(1&s&&(t.Z7z(0,Dt,3,1,"div",42,t.BUC().trackByFn,!0),t.nI1(2,"fuseFindByKey")),2&s){const e=t.XpG();t.Dyx(t.brH(2,0,e.task.tags,"id",e.tags))}}function Rt(s,o){1&s&&(t.nrm(0,"mat-icon",44),t.j41(1,"span",45),t.EFF(2,"Edit"),t.k0s()),2&s&&t.Y8G("svgIcon","heroicons_solid:pencil-square")}function jt(s,o){1&s&&(t.nrm(0,"mat-icon",44),t.j41(1,"span",45),t.EFF(2,"Add"),t.k0s()),2&s&&t.Y8G("svgIcon","heroicons_solid:plus-circle")}function $t(s,o){1&s&&t.nrm(0,"mat-icon",44),2&s&&t.Y8G("svgIcon","heroicons_solid:pencil-square")}function It(s,o){1&s&&t.nrm(0,"mat-icon",44),2&s&&t.Y8G("svgIcon","heroicons_solid:check")}function Gt(s,o){if(1&s){const e=t.RV6();t.j41(0,"div",55),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(3);return t.Njj(a.toggleTaskTag(i))}),t.nrm(1,"mat-checkbox",56),t.j41(2,"div",57),t.EFF(3),t.k0s()()}if(2&s){const e=o.$implicit,n=t.XpG(3);t.R7$(),t.Y8G("checked",n.task.tags.includes(e.id))("color","primary")("disableRipple",!0),t.R7$(2),t.SpI(" ",e.title," ")}}function Et(s,o){if(1&s&&t.Z7z(0,Gt,4,4,"div",54,t.BUC().trackByFn,!0),2&s){const e=t.XpG(2);t.Dyx(e.filteredTags)}}function Mt(s,o){if(1&s){const e=t.RV6();t.j41(0,"div",12)(1,"mat-form-field",58)(2,"input",59),t.bIt("input",function(i){const a=t.eBV(e).$implicit,l=t.XpG(3);return t.Njj(l.updateTagTitle(a,i))}),t.k0s(),t.j41(3,"button",60),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(3);return t.Njj(a.deleteTag(i))}),t.nrm(4,"mat-icon",61),t.k0s()()()}if(2&s){const e=o.$implicit;t.R7$(),t.Y8G("subscriptSizing","dynamic"),t.R7$(),t.Y8G("value",e.title),t.R7$(2),t.Y8G("svgIcon","heroicons_solid:trash")}}function wt(s,o){if(1&s&&(t.j41(0,"div",52),t.Z7z(1,Mt,5,3,"div",12,t.BUC().trackByFn,!0),t.k0s()),2&s){const e=t.XpG(2);t.R7$(),t.Dyx(e.filteredTags)}}function St(s,o){if(1&s){const e=t.RV6();t.j41(0,"div",62),t.bIt("click",function(){t.eBV(e),t.XpG();const i=t.sdS(6);return t.XpG().createTag(i.value),t.Njj(i.value="")}),t.nrm(1,"mat-icon",63),t.j41(2,"div",64),t.EFF(3,' Create "'),t.j41(4,"b"),t.EFF(5),t.k0s(),t.EFF(6,'" '),t.k0s()()}if(2&s){t.XpG();const e=t.sdS(6);t.R7$(),t.Y8G("svgIcon","heroicons_solid:plus-circle"),t.R7$(4),t.JRh(e.value)}}function Lt(s,o){if(1&s){const e=t.RV6();t.j41(0,"div",46)(1,"div",47)(2,"div",12),t.nrm(3,"mat-icon",44),t.j41(4,"div",48)(5,"input",49,6),t.bIt("input",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.filterTags(i))})("keydown",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.filterTagsInputKeyDown(i))}),t.k0s()()(),t.j41(7,"button",50),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.toggleTagsEditMode())}),t.DNE(8,$t,1,1,"mat-icon",44)(9,It,1,1,"mat-icon",44),t.k0s()(),t.j41(10,"div",51),t.DNE(11,Et,2,0)(12,wt,3,0,"div",52)(13,St,7,2,"div",53),t.k0s()()}if(2&s){const e=t.sdS(6),n=t.XpG();t.R7$(3),t.Y8G("svgIcon","heroicons_solid:magnifying-glass"),t.R7$(2),t.Y8G("maxLength",30),t.R7$(3),t.vxM(n.tagsEditMode?-1:8),t.R7$(),t.vxM(n.tagsEditMode?9:-1),t.R7$(2),t.vxM(n.tagsEditMode?-1:11),t.R7$(),t.vxM(n.tagsEditMode?12:-1),t.R7$(),t.vxM(n.shouldShowCreateTagButton(e.value)?13:-1)}}function Yt(s,o){1&s&&(t.nrm(0,"mat-icon",65),t.j41(1,"span",66),t.EFF(2,"Low"),t.k0s()),2&s&&t.Y8G("svgIcon","heroicons_mini:arrow-long-down")}function Bt(s,o){1&s&&(t.nrm(0,"mat-icon",65),t.j41(1,"span",66),t.EFF(2,"Normal"),t.k0s()),2&s&&t.Y8G("svgIcon","heroicons_solid:minus")}function Nt(s,o){1&s&&(t.nrm(0,"mat-icon",65),t.j41(1,"span",66),t.EFF(2,"High"),t.k0s()),2&s&&t.Y8G("svgIcon","heroicons_mini:arrow-long-up")}function Xt(s,o){if(1&s&&(t.EFF(0),t.nI1(1,"date")),2&s){const e=t.XpG();t.SpI(" ",t.i5U(1,1,e.task.dueDate,"longDate")," ")}}function Vt(s,o){1&s&&t.EFF(0," Not set ")}let At=(()=>{class s{constructor(e,n,i,a,l,c,g,zt,Qt,Ht){this._activatedRoute=e,this._changeDetectorRef=n,this._formBuilder=i,this._fuseConfirmationService=a,this._renderer2=l,this._router=c,this._tasksListComponent=g,this._tasksService=zt,this._overlay=Qt,this._viewContainerRef=Ht,this.tagsEditMode=!1,this._unsubscribeAll=new Y.B}ngOnInit(){this._tasksListComponent.matDrawer.open(),this.taskForm=this._formBuilder.group({id:[""],type:[""],title:[""],notes:[""],completed:[!1],dueDate:[null],priority:[0],tags:[[]],order:[0]}),this._tasksService.tags$.pipe((0,p.Q)(this._unsubscribeAll)).subscribe(e=>{this.tags=e,this.filteredTags=e,this._changeDetectorRef.markForCheck()}),this._tasksService.tasks$.pipe((0,p.Q)(this._unsubscribeAll)).subscribe(e=>{this.tasks=e,this._changeDetectorRef.markForCheck()}),this._tasksService.task$.pipe((0,p.Q)(this._unsubscribeAll)).subscribe(e=>{this._tasksListComponent.matDrawer.open(),this.task=e,this.taskForm.patchValue(e,{emitEvent:!1}),this._changeDetectorRef.markForCheck()}),this.taskForm.valueChanges.pipe((0,F.M)(e=>{this.task=(0,O.A)(this.task,e)}),(0,B.B)(300),(0,p.Q)(this._unsubscribeAll)).subscribe(e=>{this._tasksService.updateTask(e.id,e).subscribe(),this._changeDetectorRef.markForCheck()}),this._router.events.pipe((0,p.Q)(this._unsubscribeAll),(0,T.p)(e=>e instanceof m.wF)).subscribe(()=>{this._titleField.nativeElement.focus()})}ngAfterViewInit(){this._tasksListComponent.matDrawer.openedChange.pipe((0,p.Q)(this._unsubscribeAll),(0,T.p)(e=>e)).subscribe(()=>{this._titleField.nativeElement.focus()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this._tagsPanelOverlayRef&&this._tagsPanelOverlayRef.dispose()}closeDrawer(){return this._tasksListComponent.matDrawer.close()}toggleCompleted(){const e=this.taskForm.get("completed");e.setValue(!e.value)}openTagsPanel(){this._tagsPanelOverlayRef=this._overlay.create({backdropClass:"",hasBackdrop:!0,scrollStrategy:this._overlay.scrollStrategies.block(),positionStrategy:this._overlay.position().flexibleConnectedTo(this._tagsPanelOrigin.nativeElement).withFlexibleDimensions(!0).withViewportMargin(64).withLockedPosition(!0).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"}])}),this._tagsPanelOverlayRef.attachments().subscribe(()=>{this._tagsPanelOverlayRef.overlayElement.querySelector("input").focus()});const e=new A.VA(this._tagsPanel,this._viewContainerRef);this._tagsPanelOverlayRef.attach(e),this._tagsPanelOverlayRef.backdropClick().subscribe(()=>{this._tagsPanelOverlayRef&&this._tagsPanelOverlayRef.hasAttached()&&(this._tagsPanelOverlayRef.detach(),this.filteredTags=this.tags,this.tagsEditMode=!1),e&&e.isAttached&&e.detach()})}toggleTagsEditMode(){this.tagsEditMode=!this.tagsEditMode}filterTags(e){const n=e.target.value.toLowerCase();this.filteredTags=this.tags.filter(i=>i.title.toLowerCase().includes(n))}filterTagsInputKeyDown(e){if("Enter"!==e.key)return;if(0===this.filteredTags.length)return this.createTag(e.target.value),void(e.target.value="");const n=this.filteredTags[0];this.task.tags.find(a=>a===n.id)?this.deleteTagFromTask(n):this.addTagToTask(n)}createTag(e){this._tasksService.createTag({title:e}).subscribe(i=>{this.addTagToTask(i)})}updateTagTitle(e,n){e.title=n.target.value,this._tasksService.updateTag(e.id,e).pipe((0,B.B)(300)).subscribe(),this._changeDetectorRef.markForCheck()}deleteTag(e){this._tasksService.deleteTag(e.id).subscribe(),this._changeDetectorRef.markForCheck()}addTagToTask(e){this.task.tags.unshift(e.id),this.taskForm.get("tags").patchValue(this.task.tags),this._changeDetectorRef.markForCheck()}deleteTagFromTask(e){this.task.tags.splice(this.task.tags.findIndex(n=>n===e.id),1),this.taskForm.get("tags").patchValue(this.task.tags),this._changeDetectorRef.markForCheck()}toggleTaskTag(e){this.task.tags.includes(e.id)?this.deleteTagFromTask(e):this.addTagToTask(e)}shouldShowCreateTagButton(e){return!(""===e||this.tags.findIndex(n=>n.title.toLowerCase()===e.toLowerCase())>-1)}setTaskPriority(e){this.taskForm.get("priority").setValue(e)}isOverdue(){return L.c9.fromISO(this.task.dueDate).startOf("day")<L.c9.now().startOf("day")}deleteTask(){this._fuseConfirmationService.open({title:"Delete task",message:"Are you sure you want to delete this task? This action cannot be undone!",actions:{confirm:{label:"Delete"}}}).afterClosed().subscribe(n=>{if("confirmed"===n){const i=this.task.id,a=this.tasks.findIndex(g=>g.id===i),c=1===this.tasks.length&&this.tasks[0].id===i?null:this.tasks[a+(a===this.tasks.length-1?-1:1)].id;this._tasksService.deleteTask(i).subscribe(g=>{g&&this._router.navigate(c?["../",c]:["../"],{relativeTo:this._activatedRoute})}),this._changeDetectorRef.markForCheck()}})}trackByFn(e,n){return n.id||e}static{this.\u0275fac=function(n){return new(n||s)(t.rXU(m.nX),t.rXU(t.gRc),t.rXU(d.ze),t.rXU(U.G),t.rXU(t.sFG),t.rXU(m.Ix),t.rXU(V),t.rXU(x),t.rXU(ht.hJ),t.rXU(t.c1b))}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["tasks-details"]],viewQuery:function(n,i){if(1&n&&(t.GBs(_t,5),t.GBs(ft,5),t.GBs(vt,5)),2&n){let a;t.mGM(a=t.lsd())&&(i._tagsPanelOrigin=a.first),t.mGM(a=t.lsd())&&(i._tagsPanel=a.first),t.mGM(a=t.lsd())&&(i._titleField=a.first)}},decls:82,vars:53,consts:[["moreMenu","matMenu"],["titleField",""],["tagsPanelOrigin",""],["tagsPanel",""],["priorityMenu","matMenu"],["dueDatePicker",""],["newTagInput",""],[1,"flex","flex-auto"],[1,"flex","flex-auto","flex-col","overflow-y-auto","p-6","pt-10","sm:p-8","sm:pt-10",3,"formGroup"],[1,"-ml-4","-mt-3","flex","items-center","justify-between"],["mat-button","",1,"pl-3.5","pr-4",3,"click"],[1,"flex","items-center","justify-center"],[1,"flex","items-center"],["mat-icon-button","",3,"matMenuTriggerFor"],[3,"svgIcon"],["mat-menu-item","",3,"click"],["mat-icon-button","",3,"routerLink"],[1,"mb-8","mt-6"],[1,"w-full",3,"subscriptSizing"],["matInput","","cdkTextareaAutosize","",3,"formControlName","spellcheck"],[1,"mt-8"],[1,"mb-1.5","font-medium"],[1,"-m-1.5","flex","flex-wrap","items-center"],[1,"m-1.5","flex","cursor-pointer","items-center","justify-center","rounded-full","bg-gray-100","px-4","leading-9","text-gray-500","dark:bg-gray-700","dark:text-gray-300",3,"click"],[1,"mt-8","flex","flex-wrap","items-center"],[1,"font-medium"],[1,"mt-1.5","flex","cursor-pointer","items-center","rounded-full","px-4","leading-9",3,"ngClass","matMenuTriggerFor"],["mat-menu-item","",3,"click","ngClass"],[1,"inline-flex","w-full","min-w-30","items-center","justify-between","leading-5"],[1,"mr-0","text-green-600","icon-size-4","dark:text-green-500",3,"svgIcon"],[1,"mr-0","text-gray-600","icon-size-4","dark:text-gray-500",3,"svgIcon"],[1,"mr-0","text-red-600","icon-size-4","dark:text-red-500",3,"svgIcon"],[1,"ml-6"],[1,"relative","mt-1.5","flex","cursor-pointer","items-center","rounded-full","px-4","leading-9",3,"click","ngClass"],[1,"text-current","icon-size-5",3,"svgIcon"],[1,"ml-2","text-md","font-medium"],[1,"fuse-mat-dense","pointer-events-none","invisible","absolute","inset-0","-mt-2.5","opacity-0",3,"subscriptSizing"],["matInput","",3,"formControlName","matDatepicker"],["mat-button","","matDatepickerCancel","",3,"click"],["mat-flat-button","","matDatepickerApply","",1,"",3,"color"],[1,"ml-2","font-semibold"],[1,"text-primary",3,"svgIcon"],[1,"m-1.5","flex","items-center","justify-center","rounded-full","bg-gray-100","px-4","leading-9","text-gray-500","dark:bg-gray-700","dark:text-gray-300"],[1,"whitespace-nowrap","text-md","font-medium"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-1.5","whitespace-nowrap","text-md","font-medium"],[1,"bg-card","w-60","rounded","border","shadow-md"],[1,"m-3","mr-2","flex","items-center"],[1,"ml-2"],["type","text","placeholder","Enter tag name",1,"w-full","min-w-0","border-0","py-1",3,"input","keydown","maxLength"],["mat-icon-button","",1,"ml-1",3,"click"],[1,"flex","max-h-64","flex-col","overflow-y-auto","border-t","py-2"],[1,"space-y-2","py-2"],["matRipple","",1,"-ml-0.5","flex","h-10","min-h-10","cursor-pointer","items-center","pl-4","pr-3","leading-none","hover:bg-hover"],["matRipple","",1,"flex","h-10","min-h-10","cursor-pointer","items-center","pl-1","pr-4","hover:bg-hover"],["matRipple","",1,"flex","h-10","min-h-10","cursor-pointer","items-center","pl-1","pr-4","hover:bg-hover",3,"click"],[1,"pointer-events-none","flex","h-10","min-h-10","items-center",3,"checked","color","disableRipple"],[1,"ml-1"],[1,"fuse-mat-dense","mx-4","w-full",3,"subscriptSizing"],["matInput","",3,"input","value"],["mat-icon-button","","matSuffix","",3,"click"],[1,"ml-2","icon-size-5",3,"svgIcon"],["matRipple","",1,"-ml-0.5","flex","h-10","min-h-10","cursor-pointer","items-center","pl-4","pr-3","leading-none","hover:bg-hover",3,"click"],[1,"mr-2","icon-size-5",3,"svgIcon"],[1,"break-all"],[1,"text-current","icon-size-4",3,"svgIcon"],[1,"ml-2","mr-1","text-md","font-medium"]],template:function(n,i){if(1&n){const a=t.RV6();t.j41(0,"div",7)(1,"form",8)(2,"div",9)(3,"button",10),t.bIt("click",function(){return t.eBV(a),t.Njj(i.toggleCompleted())}),t.DNE(4,bt,4,1,"div",11)(5,yt,4,1,"div",11),t.k0s(),t.j41(6,"div",12)(7,"button",13),t.nrm(8,"mat-icon",14),t.k0s(),t.j41(9,"mat-menu",null,0)(11,"button",15),t.bIt("click",function(){return t.eBV(a),t.Njj(i.deleteTask())}),t.nrm(12,"mat-icon",14),t.j41(13,"span"),t.EFF(14),t.k0s()()(),t.j41(15,"a",16),t.nrm(16,"mat-icon",14),t.k0s()()(),t.nrm(17,"mat-divider",17),t.j41(18,"div")(19,"mat-form-field",18)(20,"mat-label"),t.EFF(21),t.k0s(),t.nrm(22,"textarea",19,1),t.k0s()(),t.j41(24,"div",20)(25,"div",21),t.EFF(26,"Tags"),t.k0s(),t.j41(27,"div",22),t.DNE(28,Ft,3,4),t.j41(29,"div",23,2),t.bIt("click",function(){return t.eBV(a),t.Njj(i.openTagsPanel())}),t.DNE(31,Rt,3,1)(32,jt,3,1)(33,Lt,14,7,"ng-template",null,3,t.C5r),t.k0s()()(),t.j41(35,"div",24)(36,"div")(37,"div",25),t.EFF(38,"Priority"),t.k0s(),t.j41(39,"div",26),t.DNE(40,Yt,3,1)(41,Bt,3,1)(42,Nt,3,1),t.k0s(),t.j41(43,"mat-menu",null,4)(45,"button",27),t.bIt("click",function(){return t.eBV(a),t.Njj(i.setTaskPriority(0))}),t.j41(46,"span",28)(47,"span",25),t.EFF(48,"Low"),t.k0s(),t.nrm(49,"mat-icon",29),t.k0s()(),t.j41(50,"button",27),t.bIt("click",function(){return t.eBV(a),t.Njj(i.setTaskPriority(1))}),t.j41(51,"span",28)(52,"span",25),t.EFF(53,"Normal"),t.k0s(),t.nrm(54,"mat-icon",30),t.k0s()(),t.j41(55,"button",27),t.bIt("click",function(){return t.eBV(a),t.Njj(i.setTaskPriority(2))}),t.j41(56,"span",28)(57,"span",25),t.EFF(58,"High"),t.k0s(),t.nrm(59,"mat-icon",31),t.k0s()()()(),t.j41(60,"div",32)(61,"div",25),t.EFF(62,"Due date"),t.k0s(),t.j41(63,"div",33),t.bIt("click",function(){t.eBV(a);const c=t.sdS(71);return t.Njj(c.open())}),t.nrm(64,"mat-icon",34),t.j41(65,"span",35),t.DNE(66,Xt,2,4)(67,Vt,1,0),t.k0s(),t.j41(68,"mat-form-field",36),t.nrm(69,"input",37),t.j41(70,"mat-datepicker",null,5)(72,"mat-datepicker-actions")(73,"button",38),t.bIt("click",function(){return t.eBV(a),t.Njj(i.taskForm.get("dueDate").setValue(null))}),t.EFF(74," Clear "),t.k0s(),t.j41(75,"button",39),t.EFF(76," Select "),t.k0s()()()()()()(),t.j41(77,"div",20)(78,"mat-form-field",18)(79,"mat-label"),t.EFF(80,"Notes"),t.k0s(),t.nrm(81,"textarea",19),t.k0s()()()()}if(2&n){const a=t.sdS(10),l=t.sdS(44),c=t.sdS(71);t.R7$(),t.Y8G("formGroup",i.taskForm),t.R7$(3),t.vxM(i.taskForm.get("completed").value?-1:4),t.R7$(),t.vxM(i.taskForm.get("completed").value?5:-1),t.R7$(2),t.Y8G("matMenuTriggerFor",a),t.R7$(),t.Y8G("svgIcon","heroicons_outline:ellipsis-vertical"),t.R7$(4),t.Y8G("svgIcon","heroicons_outline:trash"),t.R7$(2),t.SpI("Delete ","task"===i.task.type?"task":"section",""),t.R7$(),t.Y8G("routerLink",t.lJ4(38,Tt)),t.R7$(),t.Y8G("svgIcon","heroicons_outline:x-mark"),t.R7$(3),t.Y8G("subscriptSizing","dynamic"),t.R7$(2),t.JRh("task"===i.task.type?"Task title":"Section title"),t.R7$(),t.Y8G("formControlName","title")("spellcheck",!1),t.R7$(6),t.vxM(i.task.tags.length?28:-1),t.R7$(3),t.vxM(i.task.tags.length?31:-1),t.R7$(),t.vxM(i.task.tags.length?-1:32),t.R7$(7),t.Y8G("ngClass",t.sMw(39,Ct,0===i.task.priority,1===i.task.priority,2===i.task.priority))("matMenuTriggerFor",l),t.R7$(),t.vxM(0===i.task.priority?40:-1),t.R7$(),t.vxM(1===i.task.priority?41:-1),t.R7$(),t.vxM(2===i.task.priority?42:-1),t.R7$(3),t.Y8G("ngClass",t.eq3(43,$,0===i.task.priority)),t.R7$(4),t.Y8G("svgIcon","heroicons_mini:arrow-long-down"),t.R7$(),t.Y8G("ngClass",t.eq3(45,$,1===i.task.priority)),t.R7$(4),t.Y8G("svgIcon","heroicons_solid:minus"),t.R7$(),t.Y8G("ngClass",t.eq3(47,$,2===i.task.priority)),t.R7$(4),t.Y8G("svgIcon","heroicons_mini:arrow-long-up"),t.R7$(4),t.Y8G("ngClass",t.sMw(49,xt,!i.task.dueDate,i.task.dueDate&&!i.isOverdue(),i.task.dueDate&&i.isOverdue())),t.R7$(),t.Y8G("svgIcon","heroicons_solid:calendar"),t.R7$(2),t.vxM(i.task.dueDate?66:-1),t.R7$(),t.vxM(i.task.dueDate?-1:67),t.R7$(),t.Y8G("subscriptSizing","dynamic"),t.R7$(),t.Y8G("formControlName","dueDate")("matDatepicker",c),t.R7$(6),t.Y8G("color","primary"),t.R7$(3),t.Y8G("subscriptSizing","dynamic"),t.R7$(3),t.Y8G("formControlName","notes")("spellcheck",!1)}},dependencies:[d.YN,d.qT,d.me,d.BC,d.cb,d.X1,d.j4,d.JD,_.Hl,_.$z,_.pQ,_.iY,y.m_,y.An,D.Cn,D.kk,D.fb,D.Cp,m.Wk,w.w,w.q,b.RG,b.rl,b.nJ,b.yw,S.fS,S.fg,G.xb,G.EE,M.pZ,M.r6,E.g7,E.So,f.YU,v.X6,v.Vh,v.bZ,v.Cz,v.jj,v.T7,P.H,f.vh],encapsulation:2,changeDetection:0})}}return s})(),Pt=(()=>{class s{constructor(){}static{this.\u0275fac=function(n){return new(n||s)}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["tasks"]],decls:1,vars:0,template:function(n,i){1&n&&t.nrm(0,"router-outlet")},dependencies:[m.n3],encapsulation:2,changeDetection:0})}}return s})();var Ot=r(99437);const Ut=[{path:"",component:Pt,resolve:{tags:()=>(0,t.WQX)(x).getTags()},children:[{path:"",component:V,resolve:{tasks:()=>(0,t.WQX)(x).getTasks()},children:[{path:":id",component:At,resolve:{task:(s,o)=>{const e=(0,t.WQX)(x),n=(0,t.WQX)(m.Ix);return e.getTaskById(s.paramMap.get("id")).pipe((0,Ot.W)(i=>{console.error(i);const a=o.url.split("/").slice(0,-1).join("/");return n.navigateByUrl(a),(0,X.$)(i)}))}},canDeactivate:[(s,o,e,n)=>{let i=n.root;for(;i.firstChild;)i=i.firstChild;return!(n.url.includes("/tasks")&&!i.paramMap.get("id"))||s.closeDrawer().then(()=>!0)}]}]}]}]}}]);
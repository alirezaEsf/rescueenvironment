<p-toast />
<app-breadcrumbs id="section" [showBackButton]="false" *ngIf="!moduleApiFlag&&!addFlag && !updateFlag"></app-breadcrumbs>
<div class="content-page" *ngIf="!moduleApiFlag&&!addFlag && !updateFlag">
    <div class="grid grid-cols-1 xl:grid-cols-12 2xl:grid-cols-12 md:grid-cols-12  ">
        <div class="col-span-3 flex text-left   h-12 gap-2 mt-5-5  sm:hidden ">
            <button name="btn-search-button" pButton label="{{ 'button.search' | transloco }}"
                    style="width: 110px;margin: 3px;margin-top: 20px"
                    class="normal-button" icon="pi pi-search"
                    (click)="searchClick(true)"></button>&nbsp;&nbsp;
            <button name="btn-clear-button" pButton label="{{'button.clear'|transloco}}"
                     icon="pi pi-filter-slash"
                    class="w-[110px] my-1 px-4 py-2 normal-button "
                    [outlined]="true" (click)="clear()"></button>
        </div>
        <div class="col-span-4">
            <label class="normal-label"> <span>{{ 'party.input.partyTitle'|transloco }} :</span></label>
            <input name="input-organization-title" class="normal-input" [(ngModel)]="title"
                   (keydown.enter)="onKeydown($event)" pInputText>
        </div>
        <div class="hidden btns-search-clear sm:flex">
            <button pButton
                    label="{{'button.clear' | transloco}}"
                    icon="pi pi-filter-slash"
                    (click)="clear()"
                    [outlined]="true"
                    class="my-1 px-4 py-2 border normal-button"
            ></button>

            <button pButton
                    label="{{'button.search' | transloco}}"
                    icon="pi pi-search"
                    class="w-[110px] my-1 px-4 py-2 text-white normal-button"
                    (click)="searchClick(true)"></button>
        </div>
        <div class="col-span-12 my-2" *ngIf="!addFlag && !updateFlag && !moduleApiFlag">
            <button name="btn-create-party" pButton label="{{ 'party.button.partyTitle' | transloco }}" class="normal-button"
                    icon="pi pi-plus" (click)="showAdd()"></button>
        </div>
        <div class="col-span-12 ">
            <p-table [value]="partyList" *ngIf="!addFlag && !updateFlag && !moduleApiFlag"
                     [showCurrentPageReport]="true" [(first)]="first"
                     [currentPageReportTemplate]=paginationLabel
                     [rowsPerPageOptions]="[5,10,25,50,100]"
                     selectionMode="single" [rows]="rows" [totalRecords]="totalRecords"
            >
                <ng-template pTemplate="header">
                    <tr>
                        <th pSortableColumn="row" class="row">
                            {{ 'party.table.header.row'|transloco }}
                            <p-sortIcon field="row"></p-sortIcon>
                        </th>
                        <th pSortableColumn="title" class="title">
                            {{ 'party.table.header.partyName'|transloco }}
                            <p-sortIcon field="title"></p-sortIcon>
                        </th>
                        <th pSortableColumn="createDate" class="createDate">
                            {{ 'party.table.header.createDate'|transloco }}
                            <p-sortIcon field="createDate"></p-sortIcon>
                        </th>
                        <th pSortableColumn="status" class="status">
                            {{ 'party.table.header.status'|transloco }}
                            <p-sortIcon field="status"></p-sortIcon>
                        </th>
                        <th class="text-right border-r border-[#ebe8e8]">
                            {{ 'party.table.header.operation'|transloco }}
                        </th>
                    </tr>
                </ng-template>
                <ng-template let-i="rowIndex" pTemplate="body" let-party>
                    <tr [pSelectableRow]="party">
                        <td class="row">{{ party.row }}</td>
                        <td class="partyName"
                            [pTooltip]="party.title"
                            [tooltipDisabled]="party.title ? party.title.length < 33 : false">
                            {{ party.title | morChar32 }}
                        </td>
                        <td dir="ltr" class="createDate text-right">
                            {{ party.createDate }}
                        </td>
                        <td class="text-right">
                            <div
                                [ngClass]="{
                                 ' text-green-800 bg-green-300 ': party.status,
                                   ' text-red-800 bg-red-300 ': !party.status
                                   }"
                                class="w-[65px] float-right text-center rounded-md"
                            >
                                {{ party.status | statusPipe }}
                            </div>
                        </td>
                        <td class="text-right border-r border-[#ebe8e8]" >
                            <button name="btn-operation" (click)="setRecord(party);menu.toggle($event)" type="button"
                                    class="p-button-rounded " pButton pRipple icon="pi pi-chevron-down"
                                    ></button>&nbsp;
                            <p-menu appendTo="body" #menu [popup]="true" [model]="items"></p-menu>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>

    <div class="grid grid-cols-12 mt-4 items-center gap-4 justify-center" *ngIf="!addFlag">
        <div class="col-span-4"></div>
        <div class="flex items-center justify-center gap-2 col-span-4">
            <button
                pButton
                pRipple class="normal-button"
                [disabled]="(this.pageno) == 0"
                (click)="previousPageStatement()"
                pTooltip="{{ 'tooltip.beforePage' | transloco }}"
            >
                <i class="pi pi-arrow-right"></i>
            </button>
            <span>&nbsp;{{ pageDescription }}&nbsp;</span>
            <button
                pButton
                pRipple
                name="btn-previous-page"
                class="normal-button"
                [disabled]="this.partyList.length < pagesize"
                (click)="nextPageStatement()"
                pTooltip="{{ 'tooltip.nextPage' | transloco }}"
            >
                <i class="pi pi-arrow-left"></i>
            </button>
            <p-dropdown class="normal-dropdown-pagination"

                        [options]="pagesizeOptions"
                        optionValue="code"
                        [autoDisplayFirst]="true"
                        optionLabel="name"
                        [(ngModel)]="pagesize"
                        (onChange)="OnchangePageno($event)"
                        [disabled]="nextBtnFlag">
            </p-dropdown>
        </div>
        <div class="col-span-4"></div>
    </div>


</div>
<div class="w-full" *ngIf="addFlag&&!moduleApiFlag && !updateFlag">
    <app-party-register (close)="onClose($event)"></app-party-register>
</div>
<div class="w-full" *ngIf="updateFlag&&!addFlag&&!moduleApiFlag ">
    <app-party-update [inputUpdate]="partyDto" (close)="onClose($event)"></app-party-update>
</div>
<div class="w-full" *ngIf="moduleApiFlag&&!updateFlag&&!addFlag">
    <app-module-api-management [inputUpdate]="partyDto" (close)="onClose($event)"></app-module-api-management>
</div>

<p-toast position="top-center"></p-toast>
<app-breadcrumbs id="section"  (backClicked)="BeforeButton()"></app-breadcrumbs>

<div class="m-5">
        <p-table  [value]="logList" selectionMode="single" [lazy]="true"
                 [loading]="loading" (onRowSelect)="expandTheRowEvent($event)"
        >
            <ng-template pTemplate="header">
                <tr>
                    <th pSortableColumn="row" class="text-right row">
                       {{'apiLogs.table.header.row'|transloco}}
                        <p-sortIcon field="row"></p-sortIcon>
                    </th>
                    <th pSortableColumn="REQUESTDATE" class="text-right REQUESTDATE">
                        {{'apiLogs.table.header.RequestDate'|transloco}}
                        <p-sortIcon field="REQUESTDATE"></p-sortIcon>
                    </th>
                    <th pSortableColumn="API_NAME" class="text-right API_NAME">
                        {{'apiLogs.table.header.ApiName'|transloco}}
                        <p-sortIcon field="API_NAME"></p-sortIcon>
                    </th>
                    <th pSortableColumn="API_TITLE" class="text-right API_TITLE">
                        {{'apiLogs.table.header.ApiTitle'|transloco}}
                        <p-sortIcon field="API_TITLE"></p-sortIcon>
                    </th>
                    <th pSortableColumn="CLIENT_NAME" class="text-right CLIENT_NAME">
                        {{'apiLogs.table.header.ClientName'|transloco}}
                        <p-sortIcon field="CLIENT_NAME"></p-sortIcon>
                    </th>
                    <th pSortableColumn="STATUS" class="text-right STATUS">
                        {{ 'apiLogs.table.header.status'|transloco }}
                        <p-sortIcon field="STATUS"></p-sortIcon>
                    </th>
                    <th class="text-right border-r border-gray-200">
                        {{ 'apiLogs.table.header.operation'|transloco }}
                    </th>
                </tr>
            </ng-template>
            <ng-template let-i="rowIndex" pTemplate="body" let-log>
                <tr [pSelectableRow]="log">
                    <td class="text-right">{{log.row}}</td>
                    <td dir="ltr" class="text-right">{{log.REQUESTDATE | castToDateTime}}</td>
                    <td class="text-right" [pTooltip]="log.API_NAME"
                        [tooltipDisabled]="log.API_NAME ? log.API_NAME.length < 20 : false">
                        {{log.API_NAME | moreChar19}}
                    </td>
                    <td class="text-right" [pTooltip]="log.API_TITLE"
                        [tooltipDisabled]="log.API_TITLE ? log.API_TITLE.length < 20 : false">
                        {{log.API_TITLE | moreChar19}}
                    </td>
                    <td class="text-right" [pTooltip]="log.CLIENT_NAME"
                        [tooltipDisabled]="log.CLIENT_NAME ? log.CLIENT_NAME.length < 20 : false">
                        {{log.CLIENT_NAME | moreChar19}}
                    </td>
                    <td class="text-center">
                        <div
                            [ngStyle]="{
                'border-radius': '2.5px',
                'color': log.STATUS ? '#258F30' : '#962515',
                'background-color': log.STATUS ? '#85DC8F' : '#F18B7D',
                'width': '45px',
                'margin': '0 auto'
              }"
                            class="rounded px-1 text-xs text-center"
                        >
                            {{log.STATUS | successful}}
                        </div>
                    </td>
                    <td class="text-right border-r border-gray-200">
                        <button *ngIf="!log.expanded"
                                pButton
                                pTooltip="اطلاعات بیشتر"
                                icon="pi pi-ellipsis-h"
                                class="p-button-rounded p-button-warning"
                                (click)="expandTheRow(log)">
                        </button>
                        <button *ngIf="log.expanded"
                                pButton
                                pTooltip="بستن"
                                icon="pi pi-ellipsis-h"
                                class="p-button-rounded p-button-warning"
                                (click)="expandTheRow(log)">
                        </button>
                    </td>
                </tr>

                <tr *ngIf="log.expanded">
                    <td></td>
                    <td>
                        <label class="font-normal text-sm">
                            <span>نام سازمان :</span>
                        </label><br>
                        <label [pTooltip]="log.PARTY_TITLE"
                               [tooltipDisabled]="log.PARTY_TITLE ? log.PARTY_TITLE.length < 20 : false">
                            {{log.PARTY_TITLE | moreChar19}}
                        </label>
                    </td>
                    <td>
                        <label class="font-normal text-sm">
                            <span>عنوان ماژول :</span>
                        </label><br>
                        <label [pTooltip]="log.MODULETITLE"
                               [tooltipDisabled]="log.MODULETITLE ? log.MODULETITLE.length < 20 : false">
                            {{log.MODULETITLE | moreChar19}}
                        </label>
                    </td>
                    <td>
                        <label class="font-normal text-sm">
                            <span>آدرس Host :</span>
                        </label><br>
                        <label dir="ltr"
                               [pTooltip]="log.DESTINATIONHOST"
                               [tooltipDisabled]="log.DESTINATIONHOST ? log.DESTINATIONHOST.length < 20 : false">
                            {{log.DESTINATIONHOST | moreChar19}}
                        </label>
                    </td>
                    <td>
                        <button class="p-button-rounded "
                                pButton icon="pi pi-eye"
                                pTooltip="جزئیات لاگ"
                                (click)="show(log)">
                        </button>&nbsp;
                    </td>
                    <td></td>
                    <td></td>
                </tr>
            </ng-template>
        </p-table>




    <div class="grid grid-cols-12 mt-4 items-center gap-4 justify-center" >
        <div class="col-span-4">

        </div>

        <div class="flex items-center justify-center gap-2 col-span-4">
            <button
                pButton
                pRipple class="normal-button"
                [disabled]="+(pageno) == 0"
                (click)="previousPageStatement()"
                pTooltip="{{ 'tooltip.beforePage' | transloco }}"
            >
                <i class="pi pi-arrow-right"></i>
            </button>
            <span>&nbsp;{{ pageDescription }}&nbsp;</span>
            <button
                pButton
                pRipple
                name="btn-previous-page"
                class="normal-button"
                [disabled]="logList.length < pagesize"
                (click)="nextPageStatement()"
                pTooltip="{{ 'tooltip.nextPage' | transloco }}"
            >
                <i class="pi pi-arrow-left"></i>
            </button>
            <p-dropdown class="normal-dropdown-pagination"
                        [options]="pagesizeOptions"
                        optionValue="code"
                        [autoDisplayFirst]="true"
                        optionLabel="name"
                        [(ngModel)]="pagesize"
                        (onChange)="OnchangePageno($event)"
                       >
            </p-dropdown>
        </div>
        <div class="col-span-4"></div>
    </div>


</div>


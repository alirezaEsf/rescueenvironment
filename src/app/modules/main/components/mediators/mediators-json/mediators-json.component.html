<p-toast />
<app-breadcrumbs id="section" (backClicked)="BeforeButton()"></app-breadcrumbs>
<div class="grid flex-column">
    <p-panel header="ثبت اطلاعات مدیاتور Json">
        <p-panel header="انتخاب فایل سرویس">
            <div class="grid grid-cols-12">
                <div class="col-4">
                    <label class="normal-label">
<span class="red-color-text">* </span>
<span >عنوان مدیاتور :</span></label><br>
                    <input [(ngModel)]="title" pInputText>
                </div>
                <div class="col-4"></div>
                <div class="col-4"></div>
            </div>
            <div class="grid grid-cols-12">
                <div class="col-12">
                    <label style="margin-bottom: 6px"><span >لطفا سرویس را انتخاب کنید</span></label>&nbsp;
                    <button [disabled]="showListFlag" style="margin-top: 4px" pButton label="{{'انتخاب' | transloco}}"
                            icon="pi pi-plus"
                            (click)="showSelectApi()"></button>
                </div>

            </div>
            <br>
            <p-panel header="مشخصات سرویس">
                <div class="grid grid-cols-12">
                    <div class="col-4">
                        <label class="normal-label"> <span >عنوان ماژول :</span></label><br>
                        <div class="lblDetailsRight">
                            <label class="text-gray-700 ftextDetails"
                                   [pTooltip]="detModuleTitle"
                                   [tooltipDisabled]="detModuleTitle?detModuleTitle.length < 20:false"
                            >
                                {{detModuleTitle|threeDotDetailsPipe}}
                            </label>
                        </div>
                    </div>
                    <div class="col-4">
                        <label class="normal-label"> <span >عنوان سرویس :</span></label><br>
                        <div class="lblDetailsRight">
                            <label class="text-gray-700 ftextDetails"
                                   [pTooltip]="detModuleTitle"
                                   [tooltipDisabled]="detModuleTitle?detModuleTitle.length < 20:false"
                            >
                                {{detApiTitle|threeDotDetailsPipe}}
                            </label>
                        </div>
                    </div>
                    <div class="col-4">
                        <label class="normal-label"> <span >نام سرویس :</span></label><br>
                        <div class="lblDetailsRight">
                            <label class="text-gray-700 ftextDetails"
                                   [pTooltip]="detModuleTitle"
                                   [tooltipDisabled]="detModuleTitle?detModuleTitle.length < 20:false"
                            >
                                {{detApiName|threeDotDetailsPipe}}
                            </label>
                        </div>
                    </div>
                    <div class="col-4"></div>
                </div>
                <br>
                <hr>
                <br>
                <div class="grid grid-cols-12">
                    <div class="col-2-6">
                        <div class="col-12">
                            <button pButton label="افزودن node به خروجی جیسون" style="width: 100%;height: 30px"
                                    [disabled]="disableFlgAddAndDeleteNode" (click)="showAddKey()"></button>
                        </div>
                        <div class="col-12">
                            <button style="width: 100%;height: 30px;" pButton label="حذف node از خروجی جیسون"
                                    [disabled]="disableFlgAddAndDeleteNode" (click)="showDeleteKey()"></button>
                        </div>
                        <div class="col-12">
                            <button style="width: 100%;height: 30px;" pButton label="تایید خروجی Json"
                                    [disabled]="disableFlgAddAndDeleteNode" class="p-button-ok"
                                    (click)="Accept()"></button>
                        </div>
                        <div class="col-12">
                            <button style="width: 100%;height: 30px;" pButton label="ثبت اطلاعات مدیاتور"
                                    severity="success" (click)="registerFinal()"
                                    [disabled]="disableFlgRegister"></button>
                        </div>
                    </div>
                    <div class="col-9-4" dir="ltr" style=" border: 1px solid #a19f9d;">
                        <div class="grid grid-cols-12">
                            <div class="col-span-6">
                                <p-listbox
                                    [(ngModel)]="itemSelect"
                                    [options]="itemsListShow"
                                    [listStyle]="{ 'max-height': '150px' }"
                                    optionLabel="name">
                                    <!-- [style]="{ width: '50rem' }">-->
                                </p-listbox>
                            </div>
                            <div class="col-6 " dir="ltr">

                            </div>
                        </div>
                        <div class="col-12" dir="ltr" style="margin-top: 100px">
                            <label class="normal-label"> Type Operation Node → Node Name : Value → Path</label>
                            <div class="col-12 " dir="ltr">
                                <button pButton severity="danger" label=" حذف آیتم از لیست"
                                        icon="pi pi-trash" (click)="remove()"></button>
                            </div>
                        </div>
                    </div>
                </div>
            </p-panel>
        </p-panel>
        <div class="col-12" dir="ltr" *ngIf="showListFlag">
            <button (click)="BeforeButton()"
                    style="width: 30px!important;" pButton
                    class="btn-warning p-button-warning" icon="pi pi-arrow-right"
                    matTooltip="{{'بازگشت' | transloco}}"></button>
        </div>
    </p-panel>
</div>
<p-dialog [style]="{'width':'58%'}" [(visible)]="flagDeletedNode" [modal]="true" [draggable]="false"
          [resizable]="true" appendTo="body">
    <p-panel header="{{'پنجر حذف کلید'}}">
        <div class="grid flex-column">
            <div class="grid grid-cols-12">
                <div class="col-12">
                    <label class="normal-label"> <span >مسیر نود والد :</span></label><br>
                    <input class="input-w-100" dir="ltr" [(ngModel)]="parentNode" pInputText>
                </div>
                <div class="col-4">
                    <label class="normal-label"> <span >کلید :</span></label><br>
                    <input [(ngModel)]="keyNode" pInputText>
                </div>
                <div class="col-4"></div>
                <div class="col-12" dir="ltr" style="margin-top: 15px">
                    <button pButton label="{{'button.cancel' | transloco}}"
                             severity="danger"  icon="pi pi-times" [outlined]="true"
                            (click)="onClose()"></button>&nbsp;
                    <button pButton severity="success" label="{{'ثبت اطلاعات' | transloco}}"
                            (click)="registerNode(2)" icon="pi pi-save"></button>&nbsp;
                </div>
            </div>
        </div>
    </p-panel>
</p-dialog>
<p-dialog [style]="{'width':'58%'}" [(visible)]="flagAddNode" [modal]="true" [draggable]="false"
          [resizable]="true" appendTo="body">
    <p-panel header="{{'پنجر افزودن کلید'}}">
        <div class="grid flex-column">
            <div class="grid grid-cols-12">
                <div class="col-12">
                    <label class="normal-label"> <span >مسیر نود والد :</span></label><br>
                    <input class="input-w-100" dir="ltr" [(ngModel)]="parentNode" pInputText>
                </div>
                <div class="col-4">
                    <label class="normal-label">
<span class="red-color-text">* </span>
<span >کلید :</span></label><br>
                    <input dir="ltr" [(ngModel)]="keyNode" pInputText>
                </div>
                <div class="col-4">
                    <label class="normal-label"> <span >مقدار :</span></label><br>
                    <input dir="ltr" [(ngModel)]="valueNode" pInputText>
                </div>

                <div class="col-12" dir="rtl">
                    <label style="color: red">توجه: در صورتی که مسیر نود والد خالی یا برابر با * باشد نود جدید به
                        انتهای
                        خروجی اضافه می گردد!</label>
                </div>
                <div class="col-12" dir="ltr" style="margin-top: 15px">
                    <button pButton label="{{'button.cancel' | transloco}}"
                             severity="danger"  icon="pi pi-times" [outlined]="true"
                            (click)="onClose()"></button>&nbsp;
                    <button pButton severity="success" label="{{'ثبت اطلاعات' | transloco}}"
                            (click)="registerNode(1)" icon="pi pi-save"></button>&nbsp;
                </div>
            </div>
        </div>
    </p-panel>
</p-dialog>
<p-dialog [style]="{'width':'58%'}" [(visible)]="geeksApi" [modal]="true" [draggable]="false"
          [resizable]="true" appendTo="body">
    <p-panel header="{{'جستجوی سرویس '|transloco}}">
        <div class="grid flex-column">
            <div class="grid grid-cols-12">
                <div class="col-4">
                    <label class="normal-label"> <span >عنوان ماژول :</span></label><br>
                    <input [(ngModel)]="moduleTitle" pInputText (keydown.enter)="onKeydown($event)">
                </div>
                <div class="col-4">
                </div>
                <div class="col-4" dir="ltr">
                    <button pButton label="{{'button.search' | transloco}}" style="width: 110px;margin-top: 20px"
                            class="btnSearch btnSearchModoule" icon="pi pi-search"
                            (click)="searchApi()"></button>&nbsp;&nbsp;
                    <button pButton label="{{'button.clear'|transloco}}" [outlined]="true" icon="pi pi-filter-slash"
                            style=";margin-top: 20px; margin: 5px;" (click)="clearApi()"></button>
                </div>
                <div class="col-4">
                    <label class="normal-label"> <span >عنوان سرویس :</span></label><br>
                    <input [(ngModel)]="apiTitle" pInputText (keydown.enter)="onKeydown($event)">
                </div>
                <div class="col-4">
                    <label class="normal-label"> <span >نام سرویس :</span></label><br>
                    <input [(ngModel)]="apiName" pInputText (keydown.enter)="onKeydown($event)">
                </div>
            </div>
        </div>
        <br>
        <p-panel>
            <p-table [value]="apiList" selectionMode="single"
                     [paginator]="true" [rows]="rows" [showCurrentPageReport]="true" [(first)]="first"
                     [currentPageReportTemplate]=paginationLabel
                     [rowsPerPageOptions]="[5,10,25,50,100]">
                <ng-template pTemplate="header">
                    <tr>
                        <th class="row" >table.header.row</th>
                        <th >عنوان ماژول</th>
                        <th >عنوان سرویس</th>
                        <th >نام سرویس</th>
                        <th >operation</th>
                    </tr>
                </ng-template>
                <ng-template let-i="rowIndex" pTemplate="body" let-api>
                    <tr [pSelectableRow]="api">
                        <td class="row">{{api.row}}</td>
                        <td
                            [pTooltip]="api.moduleTitle"
                            [tooltipDisabled]="api.moduleTitle?api.moduleTitle.length < 20:false"
                        >
                            {{api.moduleTitle|moreChar19}}
                        </td>
                        <td
                            [pTooltip]="api.apiTitle"
                            [tooltipDisabled]="api.apiTitle?api.apiTitle.length < 20:false"
                        >
                            {{api.apiTitle|moreChar19}}
                        </td>
                        <td
                            [pTooltip]="api.apiName"
                            [tooltipDisabled]="api.apiName?api.apiName.length < 20:false"
                        >
                            {{api.apiName|moreChar19}}
                        </td>
                        <td style="min-width: 100px">
                            <button pButton icon="pi pi-check" label="انتخاب سرویس" dir="ltr"
                                    (click)="selectApi(api)"
                                    style="padding:.5rem 0.5rem"></button>&nbsp;
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </p-panel>
    </p-panel>
</p-dialog>

"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[185],{2871:(I,c,l)=>{l.d(c,{G:()=>h});var e=l(4020),d=l(1317);let h=(()=>{class o{constructor(r){this.commonValidationsService=r}transform(r){let u;if(r){if(r.length>19){let p;return u=r.toString(),p=this.commonValidationsService.containsPersianChars(u)?u.toString().slice(0,16)+" ...":"..."+u.toString().slice(0,16),p}return r}}static{this.\u0275fac=function(u){return new(u||o)(e.rXU(d.Bt,16))}}static{this.\u0275pipe=e.EJ8({name:"threeDotDetailsPipe",type:o,pure:!0})}}return o})()},9279:(I,c,l)=>{l.r(c),l.d(c,{RulesComponent:()=>V});var e=l(4020),d=l(8571),h=l(335),o=l(9417),R=l(1141),r=l(2242),u=l(8542),p=l(5813),T=l(177),C=l(5144),f=l(7471),b=l(8150),E=l(551),v=l(6491),D=l(8675),x=l(9734),g=l(6397),P=l(7722),B=l(3400),O=l(7730),F=l(3823),j=l(9555),S=l(507),y=l(3523),A=l(5779);const G=()=>[5,10,25,50,100];function w(n,_){1&n&&e.nrm(0,"app-breadcrumbs",6),2&n&&e.Y8G("showBackButton",!1)}function L(n,_){if(1&n){const t=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"button",9),e.nI1(3,"transloco"),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.clear())}),e.k0s(),e.j41(4,"button",10),e.nI1(5,"transloco"),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.search())}),e.k0s()(),e.j41(6,"div",11)(7,"label",12),e.EFF(8),e.nI1(9,"transloco"),e.k0s(),e.j41(10,"input",13),e.mxI("ngModelChange",function(s){e.eBV(t);const a=e.XpG();return e.DH7(a.name,s)||(a.name=s),e.Njj(s)}),e.bIt("keydown.enter",function(s){e.eBV(t);const a=e.XpG();return e.Njj(a.onKeydownSearch(s))}),e.k0s()(),e.j41(11,"div",11)(12,"label",12),e.EFF(13),e.nI1(14,"transloco"),e.k0s(),e.j41(15,"p-dropdown",14),e.mxI("ngModelChange",function(s){e.eBV(t);const a=e.XpG();return e.DH7(a.statusCode,s)||(a.statusCode=s),e.Njj(s)}),e.bIt("onChange",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.search())}),e.k0s()(),e.j41(16,"div",15)(17,"button",9),e.nI1(18,"transloco"),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.clear())}),e.k0s(),e.j41(19,"button",10),e.nI1(20,"transloco"),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.search())}),e.k0s()()()}if(2&n){const t=e.XpG();e.R7$(2),e.FS9("label",e.bMT(3,11,"button.clear")),e.Y8G("outlined",!0),e.R7$(2),e.FS9("label",e.bMT(5,13,"button.search")),e.R7$(4),e.SpI("",e.bMT(9,15,"rule.input.ruleApiName"),":"),e.R7$(2),e.R50("ngModel",t.name),e.R7$(3),e.SpI("",e.bMT(14,17,"rule.dropdown.statusCode"),":"),e.R7$(2),e.Y8G("options",t.statusCodeOptions),e.R50("ngModel",t.statusCode),e.R7$(2),e.FS9("label",e.bMT(18,19,"button.clear")),e.Y8G("outlined",!0),e.R7$(2),e.FS9("label",e.bMT(20,21,"button.search"))}}function U(n,_){if(1&n){const t=e.RV6();e.j41(0,"div",16)(1,"button",17),e.nI1(2,"transloco"),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.showAdd())}),e.k0s()()}2&n&&(e.R7$(),e.FS9("label",e.bMT(2,1,"rule.button.registerRule")))}function k(n,_){1&n&&(e.j41(0,"tr")(1,"th",22),e.EFF(2),e.nI1(3,"transloco"),e.nrm(4,"p-sortIcon",23),e.k0s(),e.j41(5,"th",24),e.EFF(6),e.nI1(7,"transloco"),e.nrm(8,"p-sortIcon",25),e.k0s(),e.j41(9,"th",26),e.EFF(10),e.nI1(11,"transloco"),e.nrm(12,"p-sortIcon",27),e.k0s(),e.j41(13,"th",28),e.EFF(14),e.nI1(15,"transloco"),e.nrm(16,"p-sortIcon",29),e.k0s(),e.j41(17,"th",30),e.EFF(18),e.nI1(19,"transloco"),e.nrm(20,"p-sortIcon",31),e.k0s(),e.j41(21,"th",32),e.EFF(22),e.nI1(23,"transloco"),e.k0s()()),2&n&&(e.R7$(2),e.SpI(" ",e.bMT(3,6,"rule.table.header.ruleId")," "),e.R7$(4),e.SpI(" ",e.bMT(7,8,"rule.table.header.ruleName")," "),e.R7$(4),e.SpI(" ",e.bMT(11,10,"rule.table.header.httpsStatus")," "),e.R7$(4),e.SpI(" ",e.bMT(15,12,"rule.table.header.messageTitle")," "),e.R7$(4),e.SpI(" ",e.bMT(19,14,"rule.table.header.ruleTemplate")," "),e.R7$(4),e.SpI(" ",e.bMT(23,16,"rule.table.header.operation")," "))}function K(n,_){if(1&n){const t=e.RV6();e.j41(0,"tr",33)(1,"td",34),e.EFF(2),e.nI1(3,"moreChar19"),e.k0s(),e.j41(4,"td",35),e.EFF(5),e.nI1(6,"moreChar19"),e.k0s(),e.j41(7,"td",36),e.EFF(8),e.k0s(),e.j41(9,"td",37),e.EFF(10),e.nI1(11,"formatRule"),e.k0s(),e.j41(12,"td",38),e.EFF(13),e.nI1(14,"moreChar19"),e.k0s(),e.j41(15,"td",32)(16,"button",39),e.bIt("click",function(s){const a=e.eBV(t).$implicit,m=e.sdS(18);return e.XpG(2).setRecord(a),e.Njj(m.toggle(s))}),e.k0s(),e.nrm(17,"p-menu",40,0),e.k0s()()}if(2&n){const t=_.$implicit,i=e.XpG(2);e.Y8G("pSelectableRow",t),e.R7$(),e.Y8G("pTooltip",t.ruleId)("tooltipDisabled",!t.ruleId||t.ruleId.toString().length<20),e.R7$(),e.SpI(" ",e.bMT(3,14,t.ruleId)," "),e.R7$(2),e.Y8G("pTooltip",t.name)("tooltipDisabled",!t.name||t.name.length<20),e.R7$(),e.SpI(" ",e.bMT(6,16,t.name)," "),e.R7$(3),e.JRh(t.httpsstatus),e.R7$(2),e.JRh(e.bMT(11,18,t.ruleTemplate)),e.R7$(2),e.Y8G("pTooltip",t.messageTitle)("tooltipDisabled",!t.messageTitle||t.messageTitle.length<20),e.R7$(),e.SpI(" ",e.bMT(14,20,t.messageTitle)," "),e.R7$(4),e.Y8G("popup",!0)("model",i.items)}}function N(n,_){if(1&n){const t=e.RV6();e.j41(0,"div",18)(1,"p-table",19),e.mxI("firstChange",function(s){e.eBV(t);const a=e.XpG();return e.DH7(a.first,s)||(a.first=s),e.Njj(s)}),e.DNE(2,k,24,18,"ng-template",20)(3,K,19,22,"ng-template",21),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(),e.Y8G("value",t.ruleList)("paginator",!0)("rows",t.rows)("showCurrentPageReport",!0),e.R50("first",t.first),e.Y8G("currentPageReportTemplate",t.paginationLabel)("rowsPerPageOptions",e.lJ4(8,G))("responsiveLayout","scroll")}}function X(n,_){if(1&n){const t=e.RV6();e.j41(0,"div",18)(1,"app-api-rule-register",41),e.bIt("close",function(s){e.eBV(t);const a=e.XpG();return e.Njj(a.onClose(s))}),e.k0s()()}}function $(n,_){if(1&n){const t=e.RV6();e.j41(0,"div",18)(1,"app-api-rule-update",42),e.bIt("close",function(s){e.eBV(t);const a=e.XpG();return e.Njj(a.onClose(s))}),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(),e.Y8G("inputUpdate",t.ruleDto)}}function W(n,_){if(1&n){const t=e.RV6();e.j41(0,"div",18)(1,"app-api-rule-condition",43),e.bIt("close",function(s){e.eBV(t);const a=e.XpG();return e.Njj(a.onClose(s))}),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(),e.Y8G("inputCondition",t.ruleDto)}}let V=(()=>{class n{constructor(t,i,s,a,m,M,Y){this.route=t,this.messagesApiFacadeService=i,this.apiGatewayService=s,this.primeng=a,this._primengProgressBarService=m,this.transloco=M,this.notifierService=Y,this.close=new e.bkB,this.dialogMessageFlag=!1,this.messageDetailFlag=!1,this.takhsisFlag=!1,this.messagesList=[],this.ruleList=[],this.addFlag=!1,this.updateFlag=!1,this.rulConditionFlag=!1,this.registerTemp={code:"",title:"",text:"",textEN:"",type:null,tableId:null},this.detailsBreadObject=[],this.statusCodeOptions=g.a.statusCode,this.categoryMessages=g.a.categoryMessages,this.typeMessages=g.a.typeMessages,this.statusCode=null,this.first=0,this.rows=10,this.first2=0,this.rows2=10,this.paginationLabel=this.transloco.translate("label.pagination.table")}chooseBread(t){return"rulesBase"===t?[{index:0,label_index0:this.transloco.translate("menu.basicInfo"),img_index0:"assets/icons/bulletin.png",rout_index0:"/home",isActive0:!1},{index:1,label_index1:this.transloco.translate("menu.rule"),rout_index1:"/rule",isActive1:!0,img_index1:"assets/icons/rule.png"},{label_index2:null,label_Detail_index2:null},{label_index3:null,label_Detail_index3:null},{label_index4:null,label_Detail_index4:null},{label_index5:null,label_Detail_index5:null},{label_index6:null,label_Detail_index6:null}]:null}scrollTop(){this.route.fragment.subscribe(t=>{const i=document.querySelector("#"+t);i&&i.scrollIntoView(!0)})}ngOnInit(){this.scrollTop(),this.detailsBreadObject=this.chooseBread("rulesBase"),this.apiGatewayService.updateApprovalDetailsBreadObject(this.detailsBreadObject),this.primeng.ripple.set(!0),this.items=[{items:[{label:this.transloco.translate("contextMenu.Conditions"),icon:"",command:()=>{this.showRuleCondition(this.tempRule)}},{label:this.transloco.translate("contextMenu.Edit"),command:()=>{this.showUpdate(this.tempRule)}}]},{label:"____________________________",items:[{label:this.transloco.translate("contextMenu.cancel")}]}],this.search(),null!=this.inputRule&&(this.name=this.inputRule.name,this.title=this.inputRule.title,this.moduleTitle=this.inputRule.moduleTitle,this.partyTitle=this.inputRule.partyTitle,this.clientName=this.inputRule.clientName),this.code&&(this.widthCode=this.code.length>22?100:50),this.name&&(this.widthName=this.name.length>22?100:50),this.title&&(this.widthTitle=this.title.length>22?100:50)}showAdd(){this.addFlag=!0}onKeydownSearch(t){"Enter"===t.key&&this.search()}onKeydownSearchMessage(t){"Enter"===t.key&&this.messageSearch()}selectedMessage(t){this.messageId="",this.messageDetailFlag=!0,this.dialogMessageFlag=!1,this.messagesList=[],this.messageId=t.messageId,this.text=t.text,this.title=t.title,this.tableId=t.tableId,this.code=t.code,this.takhsisFlag=!0,this.search()}selectedRule(){}showRuleCondition(t){this.ruleDto={ruleTemplate:null,errorText:"",httpsstatus:"",name:"",messageId:null,ruleId:null,ruleBase:null},this.ruleDto=t,this.ruleDto.ruleBase=!0,this.apiGatewayService.updateApprovalRuleId(t.ruleId),this.rulConditionFlag=!0}search(){this._primengProgressBarService.show(),this.messagesApiFacadeService.rulesearch(this.name,this.statusCode,this.messageId).subscribe(t=>{this._primengProgressBarService.hide(),this.ruleList=Array.isArray(t)?t:[t],this.ruleList.map(i=>i.status=1===i.status);for(let i=0;i<this.ruleList.length;i++)this.ruleList[i]=Object.assign(this.ruleList[i],{row:i+1})},t=>{this._primengProgressBarService.hide()})}clear(){this.name="",this.statusCode="",this.messageId="",this.title="",this.codeMessage="",this.titleMessage="",this.textMessage="",this.textENMessage="",this.tableIdMessage="",this.typeMessage="",this.search()}validationMessage(){return this.codeMessage?this.titleMessage?this.textMessage?this.tableIdMessage?!!this.typeMessage||(this.notifierService.showError({detail:this.transloco.translate("rule.dialog.message.chooseTypeMessages"),life:3e3}),!1):(this.notifierService.showError({detail:this.transloco.translate("rule.dialog.message.chooseTableId"),life:3e3}),!1):(this.notifierService.showError({detail:this.transloco.translate("rule.dialog.message.chooseFaMessage"),life:3e3}),!1):(this.notifierService.showError({detail:this.transloco.translate("rule.dialog.message.chooseTitleMessage"),life:3e3}),!1):(this.notifierService.showError({detail:this.transloco.translate("rule.dialog.message.chooseCodeMessage"),life:3e3}),!1)}onRegisterMessage(){this.validationMessage()&&(this.messagesList=[],this.messageId="",this.registerTemp.code=this.codeMessage,this.registerTemp.title=this.titleMessage,this.registerTemp.type=this.typeMessage,this.registerTemp.text=this.textMessage,this.registerTemp.textEN=this.textENMessage,this.registerTemp.tableId=this.tableIdMessage,this._primengProgressBarService.show(),this.messagesApiFacadeService.registerMessage(this.registerTemp).subscribe(t=>{this._primengProgressBarService.hide(),this.messageId=t.messageId,this.title=t.title,this.text=t.text,this.dialogMessageFlag=!1,this.search()},t=>{this._primengProgressBarService.hide()}))}showUpdate(t){this.ruleDto={ruleTemplate:null,errorText:"",status:null,httpsstatus:"",name:"",messageId:null,apiId:null,ruleId:null},this.ruleDto=t,this.updateFlag=!0}onClose(t){this.scrollTop(),this.detailsBreadObject=[{index:0,label_index0:this.transloco.translate("menu.basicInfo"),img_index0:"assets/icons/bulletin.png",rout_index0:"/home",isActive0:!1},{index:1,label_index1:this.transloco.translate("menu.rule"),rout_index1:"/rule",isActive1:!0,img_index1:"assets/icons/rule.png"},{label_index2:null,label_Detail_index2:null},{label_index3:null,label_Detail_index3:null},{label_index4:null,label_Detail_index4:null},{label_index5:null,label_Detail_index5:null},{label_index6:null,label_Detail_index6:null}],this.apiGatewayService.updateApprovalDetailsBreadObject(this.detailsBreadObject),"close"==t?(this.addFlag=!1,this.updateFlag=!1,this.rulConditionFlag=!1):"closeAndCreate"==t&&(this.addFlag=!1,this.updateFlag=!1,this.rulConditionFlag=!1,this.search())}messageSearch(){this._primengProgressBarService.show(),this.messagesApiFacadeService.messagesearch(this.statusCode,this.titleMessage,this.tableIdMessage,this.typeMessage).subscribe(t=>{this._primengProgressBarService.hide(),Array.isArray(t)?this.messagesList=t:this.messagesList.push(t)},t=>{this._primengProgressBarService.hide()})}setRecord(t){this.tempRule=t}BeforeButton(){this.close.emit("close")}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(B.nX),e.rXU(O.k),e.rXU(F.s),e.rXU(j.tl),e.rXU(S.X),e.rXU(f.JO),e.rXU(y.f))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-rules"]],inputs:{inputRule:"inputRule"},outputs:{close:"close"},decls:9,vars:7,consts:[["menu",""],["id","section",3,"showBackButton",4,"ngIf"],[1,"fle","flex-col","w-full","px-5"],["class","grid grid-cols-1 xl:grid-cols-12 2xl:grid-cols-12 md:grid-cols-12 gap-4 my-10 ",4,"ngIf"],["class","w-full flex justify-start mb-4",4,"ngIf"],["class","w-full",4,"ngIf"],["id","section",3,"showBackButton"],[1,"grid","grid-cols-1","xl:grid-cols-12","2xl:grid-cols-12","md:grid-cols-12","gap-4","my-10"],[1,"col-span-3","flex","text-left","h-12","gap-2","mt-5-5","sm:hidden"],["pButton","","icon","pi pi-filter-slash",1,"normal-button",3,"click","label","outlined"],["pButton","","icon","pi pi-search",1,"normal-button",3,"click","label"],[1,"col-span-3"],[1,"normal-label"],["pInputText","",1,"border","border-gray-300","rounded","px-3","py-2","focus:outline-none","focus:ring-2","focus:ring-blue-500","normal-input",3,"ngModelChange","keydown.enter","ngModel"],["optionValue","code","optionLabel","name",1,"normal-dropdown",3,"ngModelChange","onChange","options","ngModel"],[1,"hidden","sm:flex","sm:col-span-6","justify-start","items-center","gap-2","h-12","mt-5-5","rtl:flex-row-reverse"],[1,"w-full","flex","justify-start","mb-4"],["pButton","","icon","pi pi-plus",1,"normal-button",3,"click","label"],[1,"w-full"],["selectionMode","single",3,"firstChange","value","paginator","rows","showCurrentPageReport","first","currentPageReportTemplate","rowsPerPageOptions","responsiveLayout"],["pTemplate","header"],["pTemplate","body"],["pSortableColumn","ruleId",1,"ruleId"],["field","ruleId"],["pSortableColumn","name",1,"name"],["field","name"],["pSortableColumn","httpsstatus",1,"httpsstatus"],["field","httpsstatus"],["pSortableColumn","messageTitle",1,"messageTitle"],["field","messageTitle"],["pSortableColumn","ruleTemplate",1,"ruleTemplate"],["field","ruleTemplate"],[1,"text-right","border-r","border-[#ebe8e8]"],[3,"pSelectableRow"],[1,"ruleId",3,"pTooltip","tooltipDisabled"],[1,"name",3,"pTooltip","tooltipDisabled"],[1,"httpsstatus"],[1,"ruleTemplate"],[1,"messageTitle",3,"pTooltip","tooltipDisabled"],["type","button","pButton","","icon","pi pi-chevron-down",1,"p-button-rounded",3,"click"],["appendTo","body",3,"popup","model"],[3,"close"],[3,"close","inputUpdate"],[3,"close","inputCondition"]],template:function(i,s){1&i&&(e.DNE(0,w,1,1,"app-breadcrumbs",1),e.nrm(1,"p-toast"),e.j41(2,"div",2),e.DNE(3,L,21,23,"div",3)(4,U,3,3,"div",4)(5,N,4,9,"div",5),e.k0s(),e.DNE(6,X,2,0,"div",5)(7,$,2,1,"div",5)(8,W,2,1,"div",5)),2&i&&(e.Y8G("ngIf",!s.rulConditionFlag&&!s.addFlag&&!s.updateFlag),e.R7$(3),e.Y8G("ngIf",!s.rulConditionFlag&&!s.addFlag&&!s.updateFlag),e.R7$(),e.Y8G("ngIf",!s.rulConditionFlag&&!s.addFlag&&!s.updateFlag),e.R7$(),e.Y8G("ngIf",!s.rulConditionFlag&&!s.addFlag&&!s.updateFlag),e.R7$(),e.Y8G("ngIf",s.addFlag),e.R7$(),e.Y8G("ngIf",s.updateFlag),e.R7$(),e.Y8G("ngIf",s.rulConditionFlag))},dependencies:[d.bG,d.XI,A.Ei,d.Tg,d.d5,d.yc,h.m,o.YN,o.me,o.BC,o.vS,R._f,r.Sm,u.m_,p.M,C.W1,f.Kj,b.kr,b.ms,T.bT,E.A,v.N,D.x,x.h,P.y8],styles:["[_nghost-%COMP%]{width:100%}.ruleId[_ngcontent-%COMP%]{width:10%}.name[_ngcontent-%COMP%]{width:12%}.ruleTemplate[_ngcontent-%COMP%], .messageTitle[_ngcontent-%COMP%], .httpsstatus[_ngcontent-%COMP%]{width:8%}"]})}}return n})()}}]);
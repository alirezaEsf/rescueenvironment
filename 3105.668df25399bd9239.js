"use strict";(self.webpackChunkrescue_environment=self.webpackChunkrescue_environment||[]).push([[3105],{13105:(It,F,a)=>{a.r(F),a.d(F,{default:()=>kt});var t=a(4020),P=a(77920);let L=(()=>{class n{constructor(){}static{this.\u0275fac=function(o){return new(o||n)}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["inventory"]],decls:1,vars:0,template:function(o,i){1&o&&t.nrm(0,"router-outlet")},dependencies:[P.n3],encapsulation:2,changeDetection:0})}}return n})();var g=a(84412),h=a(88141),p=a(96697),m=a(96354),d=a(25558),D=a(18810),S=a(7673),I=a(5964),M=a(21626);let f=(()=>{class n{constructor(e){this._httpClient=e,this._brands=new g.t(null),this._categories=new g.t(null),this._pagination=new g.t(null),this._product=new g.t(null),this._products=new g.t(null),this._tags=new g.t(null),this._vendors=new g.t(null)}get brands$(){return this._brands.asObservable()}get categories$(){return this._categories.asObservable()}get pagination$(){return this._pagination.asObservable()}get product$(){return this._product.asObservable()}get products$(){return this._products.asObservable()}get tags$(){return this._tags.asObservable()}get vendors$(){return this._vendors.asObservable()}getBrands(){return this._httpClient.get("api/apps/ecommerce/inventory/brands").pipe((0,h.M)(e=>{this._brands.next(e)}))}getCategories(){return this._httpClient.get("api/apps/ecommerce/inventory/categories").pipe((0,h.M)(e=>{this._categories.next(e)}))}getProducts(e=0,o=10,i="name",r="asc",c=""){return this._httpClient.get("api/apps/ecommerce/inventory/products",{params:{page:""+e,size:""+o,sort:i,order:r,search:c}}).pipe((0,h.M)(u=>{this._pagination.next(u.pagination),this._products.next(u.products)}))}getProductById(e){return this._products.pipe((0,p.s)(1),(0,m.T)(o=>{const i=o.find(r=>r.id===e)||null;return this._product.next(i),i}),(0,d.n)(o=>o?(0,S.of)(o):(0,D.$)("Could not found product with id of "+e+"!")))}createProduct(){return this.products$.pipe((0,p.s)(1),(0,d.n)(e=>this._httpClient.post("api/apps/ecommerce/inventory/product",{}).pipe((0,m.T)(o=>(this._products.next([o,...e]),o)))))}updateProduct(e,o){return this.products$.pipe((0,p.s)(1),(0,d.n)(i=>this._httpClient.patch("api/apps/ecommerce/inventory/product",{id:e,product:o}).pipe((0,m.T)(r=>{const c=i.findIndex(u=>u.id===e);return i[c]=r,this._products.next(i),r}),(0,d.n)(r=>this.product$.pipe((0,p.s)(1),(0,I.p)(c=>c&&c.id===e),(0,h.M)(()=>(this._product.next(r),r)))))))}deleteProduct(e){return this.products$.pipe((0,p.s)(1),(0,d.n)(o=>this._httpClient.delete("api/apps/ecommerce/inventory/product",{params:{id:e}}).pipe((0,m.T)(i=>{const r=o.findIndex(c=>c.id===e);return o.splice(r,1),this._products.next(o),i}))))}getTags(){return this._httpClient.get("api/apps/ecommerce/inventory/tags").pipe((0,h.M)(e=>{this._tags.next(e)}))}createTag(e){return this.tags$.pipe((0,p.s)(1),(0,d.n)(o=>this._httpClient.post("api/apps/ecommerce/inventory/tag",{tag:e}).pipe((0,m.T)(i=>(this._tags.next([...o,i]),i)))))}updateTag(e,o){return this.tags$.pipe((0,p.s)(1),(0,d.n)(i=>this._httpClient.patch("api/apps/ecommerce/inventory/tag",{id:e,tag:o}).pipe((0,m.T)(r=>{const c=i.findIndex(u=>u.id===e);return i[c]=r,this._tags.next(i),r}))))}deleteTag(e){return this.tags$.pipe((0,p.s)(1),(0,d.n)(o=>this._httpClient.delete("api/apps/ecommerce/inventory/tag",{params:{id:e}}).pipe((0,m.T)(i=>{const r=o.findIndex(c=>c.id===e);return o.splice(r,1),this._tags.next(o),i}),(0,I.p)(i=>i),(0,d.n)(i=>this.products$.pipe((0,p.s)(1),(0,m.T)(r=>(r.forEach(c=>{const u=c.tags.findIndex(Ft=>Ft===e);u>-1&&c.tags.splice(u,1)}),i)))))))}getVendors(){return this._httpClient.get("api/apps/ecommerce/inventory/vendors").pipe((0,h.M)(e=>{this._vendors.next(e)}))}static{this.\u0275fac=function(o){return new(o||n)(t.KVO(M.Qq))}}static{this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var x=a(60177),l=a(89417),y=a(88834),T=a(82765),C=a(3),v=a(30636),$=a(99213),j=a(59042),k=a(96695),R=a(67575),G=a(82798),E=a(30450),b=a(2042),Y=a(87122),N=a(21413),_=a(56977),w=a(70152),B=a(57786),X=a(46601);const V=n=>({"pointer-events-none":n}),z=()=>[5,10,25,100],O=n=>({$implicit:n});function A(n,s){1&n&&(t.j41(0,"div",4),t.nrm(1,"mat-progress-bar",15),t.k0s()),2&n&&(t.R7$(),t.Y8G("mode","indeterminate"))}function Q(n,s){if(1&n&&t.nrm(0,"img",28),2&n){const e=t.XpG().$implicit;t.Y8G("alt","Product thumbnail image")("src",e.thumbnail,t.B4B)}}function U(n,s){1&n&&(t.j41(0,"div",29),t.EFF(1," NO THUMB "),t.k0s())}function W(n,s){1&n&&(t.j41(0,"div",34),t.nrm(1,"div",42),t.k0s())}function Z(n,s){1&n&&(t.j41(0,"div",35),t.nrm(1,"div",43),t.k0s())}function J(n,s){1&n&&(t.j41(0,"div",36),t.nrm(1,"div",44),t.k0s())}function K(n,s){1&n&&t.nrm(0,"mat-icon",38),2&n&&t.Y8G("svgIcon","heroicons_solid:check")}function H(n,s){1&n&&t.nrm(0,"mat-icon",39),2&n&&t.Y8G("svgIcon","heroicons_solid:x-mark")}function q(n,s){1&n&&t.eu8(0)}function tt(n,s){if(1&n&&t.DNE(0,q,1,0,"ng-container",45),2&n){const e=t.XpG().$implicit;t.XpG(4);const o=t.sdS(18);t.Y8G("ngTemplateOutlet",o)("ngTemplateOutletContext",t.eq3(2,O,e))}}function et(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",25)(1,"div",26)(2,"div",27),t.DNE(3,Q,1,2,"img",28)(4,U,2,0,"div",29),t.k0s()(),t.j41(5,"div",30),t.EFF(6),t.k0s(),t.j41(7,"div",31),t.EFF(8),t.k0s(),t.j41(9,"div",23),t.EFF(10),t.nI1(11,"currency"),t.k0s(),t.j41(12,"div",32)(13,"div",33),t.EFF(14),t.k0s(),t.DNE(15,W,2,0,"div",34)(16,Z,2,0,"div",35)(17,J,2,0,"div",36),t.k0s(),t.j41(18,"div",37),t.DNE(19,K,1,1,"mat-icon",38)(20,H,1,1,"mat-icon",39),t.k0s(),t.j41(21,"div")(22,"button",40),t.bIt("click",function(){const i=t.eBV(e).$implicit,r=t.XpG(4);return t.Njj(r.toggleDetails(i.id))}),t.nrm(23,"mat-icon",41),t.k0s()()(),t.j41(24,"div",17),t.DNE(25,tt,1,4,"ng-container"),t.k0s()}if(2&n){const e=s.$implicit,o=t.XpG(4);t.R7$(3),t.vxM(e.thumbnail?3:-1),t.R7$(),t.vxM(e.thumbnail?-1:4),t.R7$(2),t.SpI(" ",e.sku," "),t.R7$(2),t.SpI(" ",e.name," "),t.R7$(2),t.SpI(" ",t.ii3(11,13,e.price,"USD","symbol","1.2-2")," "),t.R7$(4),t.SpI(" ",e.stock," "),t.R7$(),t.vxM(e.stock<20?15:-1),t.R7$(),t.vxM(e.stock>=20&&e.stock<30?16:-1),t.R7$(),t.vxM(e.stock>=30?17:-1),t.R7$(2),t.vxM(e.active?19:-1),t.R7$(),t.vxM(e.active?-1:20),t.R7$(3),t.Y8G("svgIcon",(null==o.selectedProduct?null:o.selectedProduct.id)===e.id?"heroicons_solid:chevron-up":"heroicons_solid:chevron-down"),t.R7$(2),t.vxM((null==o.selectedProduct?null:o.selectedProduct.id)===e.id?25:-1)}}function nt(n,s){1&n&&t.Z7z(0,et,26,18,null,null,t.BUC().trackByFn,!0),2&n&&t.Dyx(s)}function ot(n,s){if(1&n&&(t.j41(0,"div",17)(1,"div",18),t.nrm(2,"div"),t.j41(3,"div",19),t.EFF(4," SKU "),t.k0s(),t.j41(5,"div",20),t.EFF(6,"Name"),t.k0s(),t.j41(7,"div",21),t.EFF(8," Price "),t.k0s(),t.j41(9,"div",22),t.EFF(10," Stock "),t.k0s(),t.j41(11,"div",22),t.EFF(12," Active "),t.k0s(),t.j41(13,"div",23),t.EFF(14,"Details"),t.k0s()(),t.DNE(15,nt,2,0),t.nI1(16,"async"),t.k0s(),t.nrm(17,"mat-paginator",24)),2&n){let e;const o=t.XpG(2);t.R7$(3),t.Y8G("mat-sort-header","sku"),t.R7$(2),t.Y8G("mat-sort-header","name"),t.R7$(2),t.Y8G("mat-sort-header","price"),t.R7$(2),t.Y8G("mat-sort-header","stock"),t.R7$(2),t.Y8G("mat-sort-header","active"),t.R7$(4),t.vxM((e=t.bMT(16,12,o.products$))?15:-1,e),t.R7$(2),t.Y8G("ngClass",t.eq3(14,V,o.isLoading))("length",o.pagination.length)("pageIndex",o.pagination.page)("pageSize",o.pagination.size)("pageSizeOptions",t.lJ4(16,z))("showFirstLastButtons",!0)}}function it(n,s){1&n&&(t.j41(0,"div",16),t.EFF(1," There are no products! "),t.k0s())}function rt(n,s){1&n&&t.DNE(0,ot,18,17)(1,it,2,0,"div",16),2&n&&t.vxM(s.length>0?0:1)}function st(n,s){if(1&n&&t.nrm(0,"img",53),2&n){const e=t.XpG(2);t.Y8G("src",e.selectedProductForm.get("images").value[e.selectedProductForm.get("currentImageIndex").value],t.B4B)}}function at(n,s){1&n&&(t.j41(0,"span",54),t.EFF(1,"NO IMAGE"),t.k0s())}function ct(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",55)(1,"button",87),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.cycleImages(!1))}),t.nrm(2,"mat-icon",41),t.k0s(),t.j41(3,"span",88),t.EFF(4),t.k0s(),t.j41(5,"button",87),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.cycleImages(!0))}),t.nrm(6,"mat-icon",41),t.k0s()()}if(2&n){const e=t.XpG(2);t.R7$(2),t.Y8G("svgIcon","heroicons_mini:arrow-long-left"),t.R7$(2),t.Lme(" ",e.selectedProductForm.get("currentImageIndex").value+1," of ",e.selectedProductForm.get("images").value.length," "),t.R7$(2),t.Y8G("svgIcon","heroicons_mini:arrow-long-right")}}function lt(n,s){if(1&n&&(t.j41(0,"mat-option",67),t.EFF(1),t.k0s()),2&n){const e=s.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.name," ")}}function dt(n,s){if(1&n&&(t.j41(0,"mat-option",67),t.EFF(1),t.k0s()),2&n){const e=s.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.name," ")}}function mt(n,s){if(1&n&&(t.j41(0,"mat-option",67),t.EFF(1),t.k0s()),2&n){const e=s.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.name," ")}}function pt(n,s){1&n&&t.nrm(0,"mat-icon",41),2&n&&t.Y8G("svgIcon","heroicons_solid:pencil-square")}function ut(n,s){1&n&&t.nrm(0,"mat-icon",41),2&n&&t.Y8G("svgIcon","heroicons_solid:check")}function gt(n,s){if(1&n){const e=t.RV6();t.j41(0,"mat-checkbox",90),t.bIt("change",function(i){const r=t.eBV(e).$implicit,c=t.XpG(3);return t.Njj(c.toggleProductTag(r,i))}),t.EFF(1),t.k0s()}if(2&n){const e=s.$implicit,o=t.XpG(3);t.Y8G("color","primary")("checked",o.selectedProduct.tags.includes(e.id)),t.R7$(),t.SpI(" ",e.title," ")}}function _t(n,s){if(1&n&&t.Z7z(0,gt,2,3,"mat-checkbox",89,t.BUC().trackByFn,!0),2&n){const e=t.XpG(2);t.Dyx(e.filteredTags)}}function ht(n,s){if(1&n){const e=t.RV6();t.j41(0,"mat-form-field",91)(1,"input",92),t.bIt("input",function(i){const r=t.eBV(e).$implicit,c=t.XpG(3);return t.Njj(c.updateTagTitle(r,i))}),t.k0s(),t.j41(2,"button",93),t.bIt("click",function(){const i=t.eBV(e).$implicit,r=t.XpG(3);return t.Njj(r.deleteTag(i))}),t.nrm(3,"mat-icon",41),t.k0s()()}if(2&n){const e=s.$implicit;t.Y8G("subscriptSizing","dynamic"),t.R7$(),t.Y8G("value",e.title),t.R7$(2),t.Y8G("svgIcon","heroicons_solid:trash")}}function ft(n,s){if(1&n&&(t.j41(0,"div",81),t.Z7z(1,ht,4,3,"mat-form-field",91,t.BUC().trackByFn,!0),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.Dyx(e.filteredTags)}}function vt(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",94),t.bIt("click",function(){t.eBV(e),t.XpG();const i=t.sdS(97);return t.XpG().createTag(i.value),t.Njj(i.value="")}),t.nrm(1,"mat-icon",95),t.j41(2,"div",96),t.EFF(3,' Create "'),t.j41(4,"b"),t.EFF(5),t.k0s(),t.EFF(6,'" '),t.k0s()()}if(2&n){t.XpG();const e=t.sdS(97);t.R7$(),t.Y8G("svgIcon","heroicons_solid:plus-circle"),t.R7$(4),t.JRh(e.value)}}function xt(n,s){1&n&&(t.nrm(0,"mat-icon",97),t.j41(1,"span",98),t.EFF(2,"Product updated"),t.k0s()),2&n&&t.Y8G("svgIcon","heroicons_outline:check")}function Ct(n,s){1&n&&(t.nrm(0,"mat-icon",99),t.j41(1,"span",98),t.EFF(2,"An error occurred, try again!"),t.k0s()),2&n&&t.Y8G("svgIcon","heroicons_outline:x-mark")}function bt(n,s){if(1&n&&(t.j41(0,"div",85),t.DNE(1,xt,3,1)(2,Ct,3,1),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.vxM("success"===e.flashMessage?1:-1),t.R7$(),t.vxM("error"===e.flashMessage?2:-1)}}function yt(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",46)(1,"div",47)(2,"form",48)(3,"div",49)(4,"div",50)(5,"div",51)(6,"div",52),t.DNE(7,st,1,1,"img",53)(8,at,2,0,"span",54),t.k0s(),t.DNE(9,ct,7,4,"div",55),t.k0s(),t.j41(10,"div",56)(11,"span",57),t.EFF(12,"Product status"),t.k0s(),t.j41(13,"mat-slide-toggle",58),t.EFF(14),t.k0s()()(),t.j41(15,"div",59)(16,"div",60)(17,"mat-form-field",61)(18,"mat-label"),t.EFF(19,"Name"),t.k0s(),t.nrm(20,"input",62),t.k0s(),t.j41(21,"div",63)(22,"mat-form-field",64)(23,"mat-label"),t.EFF(24,"SKU"),t.k0s(),t.nrm(25,"input",62),t.k0s(),t.j41(26,"mat-form-field",65)(27,"mat-label"),t.EFF(28,"Barcode"),t.k0s(),t.nrm(29,"input",62),t.k0s()(),t.j41(30,"div",63)(31,"mat-form-field",64)(32,"mat-label"),t.EFF(33,"Category"),t.k0s(),t.j41(34,"mat-select",66),t.Z7z(35,lt,2,2,"mat-option",67,t.fX1),t.k0s()(),t.j41(37,"mat-form-field",68)(38,"mat-label"),t.EFF(39,"Brand"),t.k0s(),t.j41(40,"mat-select",66),t.Z7z(41,dt,2,2,"mat-option",67,t.fX1),t.k0s()(),t.j41(43,"mat-form-field",69)(44,"mat-label"),t.EFF(45,"Vendor"),t.k0s(),t.j41(46,"mat-select",66),t.Z7z(47,mt,2,2,"mat-option",67,t.fX1),t.k0s()()(),t.j41(49,"div",63)(50,"mat-form-field",64)(51,"mat-label"),t.EFF(52,"Stock"),t.k0s(),t.nrm(53,"input",70),t.k0s(),t.j41(54,"mat-form-field",69)(55,"mat-label"),t.EFF(56,"Reserved"),t.k0s(),t.nrm(57,"input",70),t.k0s()()(),t.j41(58,"div",71)(59,"mat-form-field",61)(60,"mat-label"),t.EFF(61,"Cost"),t.k0s(),t.j41(62,"span",72),t.EFF(63,"$"),t.k0s(),t.nrm(64,"input",62),t.k0s(),t.j41(65,"mat-form-field",61)(66,"mat-label"),t.EFF(67,"Base Price"),t.k0s(),t.j41(68,"span",72),t.EFF(69,"$"),t.k0s(),t.nrm(70,"input",62),t.k0s(),t.j41(71,"mat-form-field",61)(72,"mat-label"),t.EFF(73,"Tax"),t.k0s(),t.j41(74,"span",73),t.EFF(75,"%"),t.k0s(),t.nrm(76,"input",70),t.k0s(),t.j41(77,"mat-form-field",61)(78,"mat-label"),t.EFF(79,"Price"),t.k0s(),t.j41(80,"span",73),t.EFF(81,"$"),t.k0s(),t.nrm(82,"input",62),t.k0s()(),t.j41(83,"div",71)(84,"mat-form-field",61)(85,"mat-label"),t.EFF(86,"Weight"),t.k0s(),t.j41(87,"span",73),t.EFF(88,"lbs."),t.k0s(),t.nrm(89,"input",62),t.k0s(),t.j41(90,"span",74),t.EFF(91,"Tags"),t.k0s(),t.j41(92,"div",75)(93,"div",76)(94,"div",77),t.nrm(95,"mat-icon",41),t.j41(96,"input",78,1),t.bIt("input",function(i){t.eBV(e);const r=t.XpG();return t.Njj(r.filterTags(i))})("keydown",function(i){t.eBV(e);const r=t.XpG();return t.Njj(r.filterTagsInputKeyDown(i))}),t.k0s()(),t.j41(98,"button",79),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.toggleTagsEditMode())}),t.DNE(99,pt,1,1,"mat-icon",41)(100,ut,1,1,"mat-icon",41),t.k0s()(),t.j41(101,"div",80),t.DNE(102,_t,2,0)(103,ft,3,0,"div",81)(104,vt,7,2,"div",82),t.k0s()()()()(),t.j41(105,"div",83)(106,"button",84),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.deleteSelectedProduct())}),t.EFF(107," Delete "),t.k0s(),t.j41(108,"div",26),t.DNE(109,bt,3,2,"div",85),t.j41(110,"button",86),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.updateSelectedProduct())}),t.EFF(111," Update "),t.k0s()()()()()()}if(2&n){const e=t.sdS(97),o=t.XpG();t.R7$(2),t.Y8G("formGroup",o.selectedProductForm),t.R7$(5),t.vxM(o.selectedProductForm.get("images").value.length?7:8),t.R7$(2),t.vxM(o.selectedProductForm.get("images").value.length?9:-1),t.R7$(4),t.Y8G("formControlName","active")("color","primary"),t.R7$(),t.SpI(" ",!0===o.selectedProductForm.get("active").value?"Active":"Disabled"," "),t.R7$(6),t.Y8G("formControlName","name"),t.R7$(5),t.Y8G("formControlName","sku"),t.R7$(4),t.Y8G("formControlName","barcode"),t.R7$(5),t.Y8G("formControlName","category"),t.R7$(),t.Dyx(o.categories),t.R7$(5),t.Y8G("formControlName","brand"),t.R7$(),t.Dyx(o.brands),t.R7$(5),t.Y8G("formControlName","vendor"),t.R7$(),t.Dyx(o.vendors),t.R7$(6),t.Y8G("formControlName","stock"),t.R7$(4),t.Y8G("formControlName","reserved"),t.R7$(7),t.Y8G("formControlName","cost"),t.R7$(6),t.Y8G("formControlName","basePrice"),t.R7$(6),t.Y8G("formControlName","taxPercent"),t.R7$(6),t.Y8G("formControlName","price"),t.R7$(7),t.Y8G("formControlName","weight"),t.R7$(6),t.Y8G("svgIcon","heroicons_solid:magnifying-glass"),t.R7$(),t.Y8G("maxLength",50),t.R7$(3),t.vxM(o.tagsEditMode?-1:99),t.R7$(),t.vxM(o.tagsEditMode?100:-1),t.R7$(2),t.vxM(o.tagsEditMode?-1:102),t.R7$(),t.vxM(o.tagsEditMode?103:-1),t.R7$(),t.vxM(o.shouldShowCreateTagButton(e.value)?104:-1),t.R7$(2),t.Y8G("color","warn"),t.R7$(3),t.vxM(o.flashMessage?109:-1),t.R7$(),t.Y8G("color","primary")}}const kt=[{path:"",pathMatch:"full",redirectTo:"inventory"},{path:"inventory",component:L,children:[{path:"",component:(()=>{class n{constructor(e,o,i,r){this._changeDetectorRef=e,this._fuseConfirmationService=o,this._formBuilder=i,this._inventoryService=r,this.flashMessage=null,this.isLoading=!1,this.searchInputControl=new l.hs,this.selectedProduct=null,this.tagsEditMode=!1,this._unsubscribeAll=new N.B}ngOnInit(){this.selectedProductForm=this._formBuilder.group({id:[""],category:[""],name:["",[l.k0.required]],description:[""],tags:[[]],sku:[""],barcode:[""],brand:[""],vendor:[""],stock:[""],reserved:[""],cost:[""],basePrice:[""],taxPercent:[""],price:[""],weight:[""],thumbnail:[""],images:[[]],currentImageIndex:[0],active:[!1]}),this._inventoryService.brands$.pipe((0,_.Q)(this._unsubscribeAll)).subscribe(e=>{this.brands=e,this._changeDetectorRef.markForCheck()}),this._inventoryService.categories$.pipe((0,_.Q)(this._unsubscribeAll)).subscribe(e=>{this.categories=e,this._changeDetectorRef.markForCheck()}),this._inventoryService.pagination$.pipe((0,_.Q)(this._unsubscribeAll)).subscribe(e=>{this.pagination=e,this._changeDetectorRef.markForCheck()}),this.products$=this._inventoryService.products$,this._inventoryService.tags$.pipe((0,_.Q)(this._unsubscribeAll)).subscribe(e=>{this.tags=e,this.filteredTags=e,this._changeDetectorRef.markForCheck()}),this._inventoryService.vendors$.pipe((0,_.Q)(this._unsubscribeAll)).subscribe(e=>{this.vendors=e,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,_.Q)(this._unsubscribeAll),(0,w.B)(300),(0,d.n)(e=>(this.closeDetails(),this.isLoading=!0,this._inventoryService.getProducts(0,10,"name","asc",e))),(0,m.T)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,_.Q)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0,this.closeDetails()}),(0,B.h)(this._sort.sortChange,this._paginator.page).pipe((0,d.n)(()=>(this.closeDetails(),this.isLoading=!0,this._inventoryService.getProducts(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction))),(0,m.T)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}toggleDetails(e){this.selectedProduct&&this.selectedProduct.id===e?this.closeDetails():this._inventoryService.getProductById(e).subscribe(o=>{this.selectedProduct=o,this.selectedProductForm.patchValue(o),this._changeDetectorRef.markForCheck()})}closeDetails(){this.selectedProduct=null}cycleImages(e=!0){const o=this.selectedProductForm.get("images").value.length,i=this.selectedProductForm.get("currentImageIndex").value,r=i+1===o?0:i+1,c=i-1<0?o-1:i-1;e?this.selectedProductForm.get("currentImageIndex").setValue(r):this.selectedProductForm.get("currentImageIndex").setValue(c)}toggleTagsEditMode(){this.tagsEditMode=!this.tagsEditMode}filterTags(e){const o=e.target.value.toLowerCase();this.filteredTags=this.tags.filter(i=>i.title.toLowerCase().includes(o))}filterTagsInputKeyDown(e){if("Enter"!==e.key)return;if(0===this.filteredTags.length)return this.createTag(e.target.value),void(e.target.value="");const o=this.filteredTags[0];this.selectedProduct.tags.find(r=>r===o.id)?this.removeTagFromProduct(o):this.addTagToProduct(o)}createTag(e){this._inventoryService.createTag({title:e}).subscribe(i=>{this.addTagToProduct(i)})}updateTagTitle(e,o){e.title=o.target.value,this._inventoryService.updateTag(e.id,e).pipe((0,w.B)(300)).subscribe(),this._changeDetectorRef.markForCheck()}deleteTag(e){this._inventoryService.deleteTag(e.id).subscribe(),this._changeDetectorRef.markForCheck()}addTagToProduct(e){this.selectedProduct.tags.unshift(e.id),this.selectedProductForm.get("tags").patchValue(this.selectedProduct.tags),this._changeDetectorRef.markForCheck()}removeTagFromProduct(e){this.selectedProduct.tags.splice(this.selectedProduct.tags.findIndex(o=>o===e.id),1),this.selectedProductForm.get("tags").patchValue(this.selectedProduct.tags),this._changeDetectorRef.markForCheck()}toggleProductTag(e,o){o.checked?this.addTagToProduct(e):this.removeTagFromProduct(e)}shouldShowCreateTagButton(e){return!(""===e||this.tags.findIndex(o=>o.title.toLowerCase()===e.toLowerCase())>-1)}createProduct(){this._inventoryService.createProduct().subscribe(e=>{this.selectedProduct=e,this.selectedProductForm.patchValue(e),this._changeDetectorRef.markForCheck()})}updateSelectedProduct(){const e=this.selectedProductForm.getRawValue();delete e.currentImageIndex,this._inventoryService.updateProduct(e.id,e).subscribe(()=>{this.showFlashMessage("success")})}deleteSelectedProduct(){this._fuseConfirmationService.open({title:"Delete product",message:"Are you sure you want to remove this product? This action cannot be undone!",actions:{confirm:{label:"Delete"}}}).afterClosed().subscribe(o=>{if("confirmed"===o){const i=this.selectedProductForm.getRawValue();this._inventoryService.deleteProduct(i.id).subscribe(()=>{this.closeDetails()})}})}showFlashMessage(e){this.flashMessage=e,this._changeDetectorRef.markForCheck(),setTimeout(()=>{this.flashMessage=null,this._changeDetectorRef.markForCheck()},3e3)}trackByFn(e,o){return o.id||e}static{this.\u0275fac=function(o){return new(o||n)(t.rXU(t.gRc),t.rXU(X.G),t.rXU(l.ze),t.rXU(f))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["inventory-list"]],viewQuery:function(o,i){if(1&o&&(t.GBs(k.iy,5),t.GBs(b.B4,5)),2&o){let r;t.mGM(r=t.lsd())&&(i._paginator=r.first),t.mGM(r=t.lsd())&&(i._sort=r.first)}},decls:19,vars:11,consts:[["rowDetailsTemplate",""],["newTagInput",""],[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"absolute","inset-x-0","bottom-0"],[1,"text-4xl","font-extrabold","tracking-tight"],[1,"mt-6","flex","shrink-0","items-center","sm:ml-4","sm:mt-0"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-flat-button","",1,"ml-4",3,"click","color"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[3,"mode"],[1,"border-t","p-8","text-center","text-4xl","font-semibold","tracking-tight","sm:p-16"],[1,"grid"],["matSort","","matSortDisableClear","",1,"inventory-grid","text-secondary","sticky","top-0","z-10","grid","gap-4","bg-gray-50","px-6","py-4","text-md","font-semibold","shadow","dark:bg-black","dark:bg-opacity-5","md:px-8"],[1,"hidden","md:block",3,"mat-sort-header"],[3,"mat-sort-header"],[1,"hidden","sm:block",3,"mat-sort-header"],[1,"hidden","lg:block",3,"mat-sort-header"],[1,"hidden","sm:block"],[1,"z-10","border-b","bg-gray-50","dark:bg-transparent","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-b-0","sm:border-t",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"inventory-grid","grid","items-center","gap-4","border-b","px-6","py-3","md:px-8"],[1,"flex","items-center"],[1,"relative","mr-6","flex","h-12","w-12","flex-0","items-center","justify-center","overflow-hidden","rounded","border"],[1,"w-8",3,"alt","src"],[1,"flex","h-full","w-full","items-center","justify-center","text-center","text-xs","font-semibold","uppercase","leading-none"],[1,"hidden","truncate","md:block"],[1,"truncate"],[1,"hidden","items-center","lg:flex"],[1,"min-w-4"],[1,"ml-2","flex","h-4","w-1","items-end","overflow-hidden","rounded","bg-red-200"],[1,"ml-2","flex","h-4","w-1","items-end","overflow-hidden","rounded","bg-orange-200"],[1,"ml-2","flex","h-4","w-1","items-end","overflow-hidden","rounded","bg-green-100"],[1,"hidden","lg:block"],[1,"text-green-400","icon-size-5",3,"svgIcon"],[1,"text-gray-400","icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"h-7","min-h-7","min-w-10","px-2","leading-6",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"flex","h-1/3","w-full","bg-red-600"],[1,"flex","h-2/4","w-full","bg-orange-400"],[1,"flex","h-full","w-full","bg-green-400"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"overflow-hidden","shadow-lg"],[1,"flex","border-b"],[1,"flex","w-full","flex-col",3,"formGroup"],[1,"flex","flex-col","p-8","sm:flex-row"],[1,"mb-8","flex","flex-col","items-center","sm:mb-0","sm:items-start"],[1,"flex","flex-col","items-center"],[1,"h-44","w-32","overflow-hidden","rounded","border"],[1,"h-full","w-full","object-cover",3,"src"],[1,"flex","min-h-20","items-center","text-lg","font-semibold"],[1,"mt-2","flex","items-center","whitespace-nowrap"],[1,"mt-8","flex","flex-col"],[1,"mb-2","font-semibold"],[3,"formControlName","color"],[1,"flex","flex-auto","flex-wrap"],[1,"flex","w-full","flex-col","sm:pl-8","lg:w-2/4"],[1,"w-full"],["matInput","",3,"formControlName"],[1,"flex"],[1,"w-1/3","pr-2"],[1,"w-2/3","pl-2"],[3,"formControlName"],[3,"value"],[1,"w-1/3","px-2"],[1,"w-1/3","pl-2"],["type","number","matInput","",3,"formControlName"],[1,"flex","w-full","flex-col","sm:pl-8","lg:w-1/4"],["matPrefix",""],["matSuffix",""],[1,"mb-px","font-medium","leading-tight"],[1,"mt-1.5","overflow-hidden","rounded-md","border","border-gray-300","shadow-sm","dark:border-gray-500"],[1,"-my-px","flex","items-center","px-3","py-2"],[1,"flex","min-w-0","flex-auto","items-center"],["type","text","placeholder","Enter tag name",1,"ml-2","min-w-0","border-0","py-1",3,"input","keydown","maxLength"],["mat-icon-button","",1,"ml-3","h-8","min-h-8","w-8",3,"click"],[1,"h-44","overflow-y-auto","border-t","border-gray-300","leading-none","dark:border-gray-500"],[1,"space-y-2","p-4"],["matRipple","",1,"-ml-0.5","flex","h-10","min-h-10","cursor-pointer","items-center","border-t","pl-4","pr-3","leading-none","dark:hover:bg-hover","hover:bg-gray-50"],[1,"flex","w-full","items-center","justify-between","border-t","px-8","py-4"],["mat-button","",1,"-ml-4",3,"click","color"],[1,"mr-4","flex","items-center"],["mat-flat-button","",3,"click","color"],["mat-icon-button","",3,"click"],[1,"font-sm","mx-2"],[1,"flex","h-10","min-h-10","items-center","pl-1","pr-4",3,"color","checked"],[1,"flex","h-10","min-h-10","items-center","pl-1","pr-4",3,"change","color","checked"],[1,"fuse-mat-dense","w-full",3,"subscriptSizing"],["matInput","",3,"input","value"],["mat-icon-button","","matSuffix","",3,"click"],["matRipple","",1,"-ml-0.5","flex","h-10","min-h-10","cursor-pointer","items-center","border-t","pl-4","pr-3","leading-none","dark:hover:bg-hover","hover:bg-gray-50",3,"click"],[1,"mr-2","icon-size-5",3,"svgIcon"],[1,"break-all"],[1,"text-green-500",3,"svgIcon"],[1,"ml-2"],[1,"text-red-500",3,"svgIcon"]],template:function(o,i){if(1&o){const r=t.RV6();t.j41(0,"div",2)(1,"div",3),t.DNE(2,A,2,1,"div",4),t.j41(3,"div",5),t.EFF(4,"Inventory"),t.k0s(),t.j41(5,"div",6)(6,"mat-form-field",7),t.nrm(7,"mat-icon",8)(8,"input",9),t.k0s(),t.j41(9,"button",10),t.bIt("click",function(){return t.eBV(r),t.Njj(i.createProduct())}),t.nrm(10,"mat-icon",11),t.j41(11,"span",12),t.EFF(12,"Add"),t.k0s()()()(),t.j41(13,"div",13)(14,"div",14),t.DNE(15,rt,2,1),t.nI1(16,"async"),t.DNE(17,yt,112,29,"ng-template",null,0,t.C5r),t.k0s()()()}if(2&o){let r;t.R7$(2),t.vxM(i.isLoading?2:-1),t.R7$(4),t.Y8G("subscriptSizing","dynamic"),t.R7$(),t.Y8G("svgIcon","heroicons_solid:magnifying-glass"),t.R7$(),t.Y8G("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Search products"),t.R7$(),t.Y8G("color","primary"),t.R7$(),t.Y8G("svgIcon","heroicons_outline:plus"),t.R7$(5),t.vxM((r=t.bMT(16,9,i.products$))?15:-1,r)}},dependencies:[R.PO,R.HM,v.RG,v.rl,v.nJ,v.JW,v.yw,$.m_,$.An,j.fS,j.fg,l.YN,l.qT,l.me,l.Q0,l.BC,l.cb,l.X1,l.l_,l.j4,l.JD,y.Hl,y.$z,y.iY,b.NQ,b.B4,b.aE,x.T3,k.Ou,k.iy,x.YU,E.mV,E.sG,G.Ve,G.VO,C.wT,C.Sy,T.g7,T.So,C.pZ,C.r6,x.Jj,x.oe],styles:[".inventory-grid{grid-template-columns:48px auto 40px}@media (min-width: 600px){.inventory-grid{grid-template-columns:48px auto 112px 72px}}@media (min-width: 960px){.inventory-grid{grid-template-columns:48px 112px auto 112px 72px}}@media (min-width: 1280px){.inventory-grid{grid-template-columns:48px 112px auto 112px 96px 96px 72px}}\n"],encapsulation:2,data:{animation:Y.X},changeDetection:0})}}return n})(),resolve:{brands:()=>(0,t.WQX)(f).getBrands(),categories:()=>(0,t.WQX)(f).getCategories(),products:()=>(0,t.WQX)(f).getProducts(),tags:()=>(0,t.WQX)(f).getTags(),vendors:()=>(0,t.WQX)(f).getVendors()}}]}]}}]);